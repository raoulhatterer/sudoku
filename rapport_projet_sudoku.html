<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">
<head>
<!-- 2019-08-29 jeu. 02:39 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Diplôme Inter-Universitaire</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Raoul HATTERER &amp; Jean-Luc COSSALTER" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Diplôme Inter-Universitaire
<br />
<span class="subtitle">Projet Sudoku</span>
</h1>
<div id="table-of-contents">
<h2>Table des matières</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org65eb9f7">1. Introduction</a></li>
<li><a href="#orgb0bb6b1">2. Première version</a>
<ul>
<li><a href="#orgca9d5a4">2.1. L'interface homme-machine</a>
<ul>
<li><a href="#org39b838b">2.1.1. Au démarrage</a></li>
<li><a href="#org3d8635e">2.1.2. Nouvelle partie</a></li>
<li><a href="#org70b69e4">2.1.3. Début de partie</a></li>
<li><a href="#org25224e3">2.1.4. Placer un symbole sur la grille</a></li>
<li><a href="#orge7e56ba">2.1.5. Effacer un symbole de la grille</a></li>
<li><a href="#orgc125b43">2.1.6. Menus</a></li>
<li><a href="#orgc11e23f">2.1.7. Aides</a></li>
</ul>
</li>
<li><a href="#org1f54a3a">2.2. Le code</a>
<ul>
<li><a href="#org09a077a">2.2.1. Documentation</a></li>
<li><a href="#org3d667f1">2.2.2. Multiplateforme</a></li>
</ul>
</li>
<li><a href="#orgdfbd040">2.3. La démarche</a>
<ul>
<li><a href="#orgef44589">2.3.1. Réflexion initiale</a></li>
<li><a href="#org7c60d7a">2.3.2. Tirage d'une grille</a></li>
<li><a href="#orga34c55c">2.3.3. Solveur</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgde0fe16">3. Deuxième version</a>
<ul>
<li><a href="#org45bef49">3.1. L'interface homme-machine</a>
<ul>
<li><a href="#orge440e53">3.1.1. Partie affichage : Grille, barre des chiffres et gomme</a></li>
<li><a href="#org9c1431c">3.1.2. Partie menu : boutons</a></li>
</ul>
</li>
<li><a href="#orgd34c89e">3.2. Explications sur les fonctions utilisées</a>
<ul>
<li><a href="#org833e38d">3.2.1. Intersection</a></li>
<li><a href="#org430e6be">3.2.2. Tests sur les listes</a></li>
<li><a href="#orgbb7aba2">3.2.3. Les tests de remplissage</a></li>
<li><a href="#org4c10e9c">3.2.4. Tests pour la résolution</a></li>
<li><a href="#orgdd2193b">3.2.5. Fonctions pour la création des grilles (grilles simples par soustraction)</a></li>
</ul>
</li>
<li><a href="#orgad7dade">3.3. Les fonctions de résolution</a>
<ul>
<li><a href="#org6d3201f">3.3.1. Première fonction de résolution:  <code>ou_le_nombre_peut_etre</code></a></li>
<li><a href="#orgda64f72">3.3.2. Groupes nus et cachés</a></li>
<li><a href="#orgc419ffa">3.3.3. Groupes nus</a></li>
<li><a href="#org8b00484">3.3.4. Groupes cachés</a></li>
<li><a href="#org570de18">3.3.5. X-WING</a></li>
<li><a href="#orgba33e76">3.3.6. Sword-fish</a></li>
<li><a href="#orge1eb566">3.3.7. Cas où un choix s'impose</a></li>
</ul>
</li>
<li><a href="#org4160ef5">3.4. La résolution</a></li>
<li><a href="#org1771f92">3.5. Épilogue</a></li>
</ul>
</li>
<li><a href="#org2d9f292">4. Troisième version</a></li>
</ul>
</div>
</div>

<div id="outline-container-org65eb9f7" class="outline-2">
<h2 id="org65eb9f7"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
Nous avons réalisé trois versions du jeu de Sudoku. La première utilise une pile et remplit la grille au fur et à mesure en s'assurant que les symboles déjà placés autorisent le placement. La seconde utilise les méthodes de résolution classiques comme singleton nu, singleton caché, élimination indirecte, XWING, SWORD-fish, etc. Enfin, la troisième version est une version web qui permet de jouer et de vérifier la grille en utilisant Javascript.    
</p>
</div>
</div>

<div id="outline-container-orgb0bb6b1" class="outline-2">
<h2 id="orgb0bb6b1"><span class="section-number-2">2</span> Première version</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgca9d5a4" class="outline-3">
<h3 id="orgca9d5a4"><span class="section-number-3">2.1</span> L'interface homme-machine</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-org39b838b" class="outline-4">
<h4 id="org39b838b"><span class="section-number-4">2.1.1</span> Au démarrage</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
Au démarrage (figure <a href="#org1795c36">1</a>) la grille de Sudoku apparaît vide au centre de la fenêtre.
Sur la gauche, la jauge de remplissage est vide.
La pioche, au bas de la fenêtre, indique que neuf symboles de chaque sorte restent à placer sur la grille.
</p>

<p>
Sur la droite, un bouton <b>Nouvelle partie</b> de couleur distinctive permet d'amorcer une nouvelle partie.
</p>


<div id="org1795c36" class="figure">
<p><img src="./images/au_demarrage.png" alt="au_demarrage.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;1&nbsp;: </span>au démarrage</p>
</div>
</div>
</div>

<div id="outline-container-org3d8635e" class="outline-4">
<h4 id="org3d8635e"><span class="section-number-4">2.1.2</span> Nouvelle partie</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
La grille est tirée de façon aléatoire et secrète.
La pioche, au bas de la fenêtre (figure <a href="#org9e5d079">2</a>) est vide: elle indique que tous les symboles ont été placés sur la grille.
Sur la gauche, la jauge de remplissage est pleine.
Sur la droite, un curseur est apparu, il permet de choisir le niveau de difficulté. Un bouton <b>Commencer</b> de couleur distinctive permet au joueur de commencer la partie.
</p>

<div id="org9e5d079" class="figure">
<p><img src="./images/choix_du_niveau.png" alt="choix_du_niveau.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;2&nbsp;: </span>choix du niveau</p>
</div>
</div>
</div>

<div id="outline-container-org70b69e4" class="outline-4">
<h4 id="org70b69e4"><span class="section-number-4">2.1.3</span> Début de partie</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
La grille pleine est vidée aléatoirement jusqu'à atteindre le niveau souhaité par le joueur. 
La jauge de remplissage et la pioche se retrouvent partiellement remplies.
La grille est révélée au joueur et les cases dors et déjà remplies sont gelées : le joueur ne peut plus ni les effacer ni les modifier.
Sur la gauche, le chronomètre est mis en marche et décompte le temps qui s'écoule.  
</p>



<div id="org05f4569" class="figure">
<p><img src="./images/debut_de_partie.png" alt="debut_de_partie.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;3&nbsp;: </span>début de partie</p>
</div>
</div>
</div>

<div id="outline-container-org25224e3" class="outline-4">
<h4 id="org25224e3"><span class="section-number-4">2.1.4</span> Placer un symbole sur la grille</h4>
<div class="outline-text-4" id="text-2-1-4">
<p>
Pour placer un symbole sur la grille, le joueur commence par sélectionner le symbole qu'il souhaite placer soit en le choisissant sur la grille, soit en le choisissant dans la pioche. Le symbole sélectionné apparaît alors d'une couleur distinctive (figure <a href="#org5f01394">4</a>).
</p>


<div id="org5f01394" class="figure">
<p><img src="./images/selectionner_un_symbole.png" alt="selectionner_un_symbole.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;4&nbsp;: </span>sélectionner un symbole</p>
</div>

<p>
Le joueur clique alors sur une case vide pour y placer le symbole.
Si la case est susceptible d'accepter le symbole celui est placé (figure <a href="#org4fbded4">5</a>). 
La pioche et la jauge de remplissage évoluent en conséquence.
</p>


<div id="org4fbded4" class="figure">
<p><img src="./images/placer_un_symbole.png" alt="placer_un_symbole.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;5&nbsp;: </span>placer un symbole</p>
</div>
</div>
</div>

<div id="outline-container-orge7e56ba" class="outline-4">
<h4 id="orge7e56ba"><span class="section-number-4">2.1.5</span> Effacer un symbole de la grille</h4>
<div class="outline-text-4" id="text-2-1-5">
<p>
Pour effacer un symbole, le joueur sélectionne le  bouton d'effacement <b>X</b> à droite de la pioche. Ce bouton apparaît alors en rouge (figure <a href="#org3295f4c">6</a>).
Ce bouton agit en bascule: si le joueur clique dessus une nouvelle fois, on sort du mode effacement. On peut aussi en sortir en sélectionnant un autre symbole.
</p>

<p>
Quand le mode effacement est actif, à chaque fois que le joueur clique sur une case pleine de la grille, celle-ci est effacée.
La pioche et la jauge de remplissage évoluent en conséquence.
</p>


<div id="org3295f4c" class="figure">
<p><img src="./images/effacer_un_symbole.png" alt="effacer_un_symbole.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;6&nbsp;: </span>effacer un symbole</p>
</div>
</div>
</div>

<div id="outline-container-orgc125b43" class="outline-4">
<h4 id="orgc125b43"><span class="section-number-4">2.1.6</span> Menus</h4>
<div class="outline-text-4" id="text-2-1-6">
<p>
En haut de la fenêtre se trouve la barre de menu qui comporte:
</p>
<ul class="org-ul">
<li>le menu fichier (figure <a href="#org1b970b9">7</a>) qui permet notamment d'ouvrir un fichier (figure <a href="#org2f5e431">8</a>). Le format <b>sdk</b> n'est pas encore implémenté, il faut donc utiliser le format <b>csv</b>.</li>
</ul>

<div id="org1b970b9" class="figure">
<p><img src="./images/menu_fichier.png" alt="menu_fichier.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;7&nbsp;: </span>menu fichier</p>
</div>


<div id="org2f5e431" class="figure">
<p><img src="./images/ouvrir.png" alt="ouvrir.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;8&nbsp;: </span>ouvrir un fichier</p>
</div>

<ul class="org-ul">
<li>le menu langue (figure <a href="#org6127e94">9</a>) permet de choisir la langue de l'interface parmi français, anglais (figure <a href="#orgbd4813a">10</a>) et grec.</li>
</ul>


<div id="org6127e94" class="figure">
<p><img src="./images/choix_langue.png" alt="choix_langue.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;9&nbsp;: </span>choix de la langue</p>
</div>


<div id="orgbd4813a" class="figure">
<p><img src="./images/anglais.png" alt="anglais.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;10&nbsp;: </span>interface en anglais</p>
</div>

<ul class="org-ul">
<li>le menu afficher (figure <a href="#org411a0ef">11</a>) qui permet d'afficher les <b>outils développeur</b> (figure <a href="#org30a80f2">12</a>), le  <b>chronomètre</b> et une fenêtre <b>À propos</b>.</li>
</ul>

<div id="org411a0ef" class="figure">
<p><img src="./images/menu_afficher.png" alt="menu_afficher.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;11&nbsp;: </span>menu afficher</p>
</div>



<div id="org30a80f2" class="figure">
<p><img src="./images/outils.png" alt="outils.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;12&nbsp;: </span>les outils sont affichés au dessus du chronomètre</p>
</div>

<p>
Si le joueur renonce à remplir la grille, il peut recourir au solveur. S'il a déjà placé des symboles sur la grille, il doit cliquer sur <b>Recommencer</b> puis sur <b>Solveur</b>. 
</p>


<div id="org60de071" class="figure">
<p><img src="./images/victoire.png" alt="victoire.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;13&nbsp;: </span>victoire</p>
</div>
</div>
</div>

<div id="outline-container-orgc11e23f" class="outline-4">
<h4 id="orgc11e23f"><span class="section-number-4">2.1.7</span> Aides</h4>
<div class="outline-text-4" id="text-2-1-7">
<p>
Le joueur peut activer des aides en cochant les cases aides qui sont situées en haut, à droite de la grille. 
</p>
<ul class="org-ul">
<li>l'aide <code>Grille</code> permet d'afficher (en haut à droite) les prétendants au survol des cases (figure <a href="#org32934d2">14</a>). Au départ, toutes les cases admettent les neuf symboles comme prétendants. Puis, au fur et à mesure du remplissage, les symboles présents dans les cases cousines de la même ligne, colonne ou bloc 3x3 sont déduites de la liste des prétendants.</li>
</ul>


<div id="org32934d2" class="figure">
<p><img src="./images/pretendants.png" alt="pretendants.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;14&nbsp;: </span>prétendants</p>
</div>

<ul class="org-ul">
<li>l'aide <code>Pioche</code> permet d'indiquer (figure <a href="#org72f709d">15</a> à gauche du <b>X</b>) les destinations envisageables pour les symboles de la pioche si l'on survole le cardinal de la pioche quand un symbole est sélectionné. Le bouton <b>Index cases</b> permet de révéler de façon transitoire les index des cases tant que le bouton de la souris est maintenu enfoncé.</li>
</ul>


<div id="org72f709d" class="figure">
<p><img src="./images/destinations.png" alt="destinations.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;15&nbsp;: </span>destinations</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org1f54a3a" class="outline-3">
<h3 id="org1f54a3a"><span class="section-number-3">2.2</span> Le code</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-org09a077a" class="outline-4">
<h4 id="org09a077a"><span class="section-number-4">2.2.1</span> Documentation</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
Le code est documenté par <i>docstring</i> python. Cela procure une documentation accessible depuis la console. 
Par exemple, la classe <code>Case</code> (extrait de programme <a href="#orgebe2690">1</a>) à une documentation intégrée accessible en tapant <code>help(Case)</code> dans la console python.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;1&nbsp;: </span>la classe <code>Case</code> comporte énormément de documentation</label><pre class="src src-python" id="orgebe2690"><span class="linenr">30: </span><span style="color: #a020f0;">class</span> <span style="color: #228b22;">Case</span>(Button):
<span class="linenr">31: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #8b2252;">"""</span>
<span class="linenr">32: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   Classe repr&#233;sentant une case de la grille de Sudoku.</span>
<span class="linenr">33: </span>
<span class="linenr">34: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   H&#233;ritage : Une case se configure comme une bouton.</span>
<span class="linenr">35: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   mais poss&#232;de des attributs et des m&#233;thodes suppl&#233;mentaires.</span>
<span class="linenr">36: </span>
<span class="linenr">37: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   attributs:</span>
<span class="linenr">38: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   ---------</span>
<span class="linenr">39: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   index : Chaque case a un index compris entre 0 et 80 qui indique</span>
<span class="linenr">40: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   sa position dans la grille.</span>
<span class="linenr">41: </span>
<span class="linenr">42: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   contenu : Une case non vide a un `contenu`, le symbole qui est affich&#233;</span>
<span class="linenr">43: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   quand on tape le nom de la case dans l'interpr&#233;teur.</span>
<span class="linenr">44: </span>
<span class="linenr">45: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   pretendants : Une case vide &#224; des pr&#233;tendants (symboles qu'il est  possible</span>
<span class="linenr">46: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   de mettre cette case).</span>
<span class="linenr">47: </span>
<span class="linenr">48: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   index_cousines : Une case a des cases cousines qui sont soit dans la m&#234;me</span>
<span class="linenr">49: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   ligne, soit dans la m&#234;me colonne soit dans le m&#234;me carr&#233; (3 x 3). Une case</span>
<span class="linenr">50: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   conserve les index de ses cousines.</span>
<span class="linenr">51: </span>
<span class="linenr">52: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   exemple :</span>
<span class="linenr">53: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   -------</span>
<span class="linenr">54: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   &gt;&gt;&gt; root = Tk()</span>
<span class="linenr">55: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   &gt;&gt;&gt; index_cousines = list()</span>
<span class="linenr">56: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   &gt;&gt;&gt; ma_case = Case(root, 0, index_cousines, text="une case")</span>
<span class="linenr">57: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   &gt;&gt;&gt; ma_case.pack()</span>
<span class="linenr">58: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   &gt;&gt;&gt; ma_case.pretendants</span>
<span class="linenr">59: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   ['1', '2', '3', '4', '5', '6', '7', '8', '9']</span>
<span class="linenr">60: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   &gt;&gt;&gt; ma_case</span>
<span class="linenr">61: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   0</span>
<span class="linenr">62: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   """</span>
</pre>
</div>

<p>
Il en va de même pour toutes les classes utilisées dans le programme:
</p>
<ul class="org-ul">
<li>la classe <code>Case</code></li>
<li>la classe <code>Grille</code> qui utilise la classe <code>Case</code> (extrait de programme <a href="#org86bed3e">2</a>) tout en disposant d'attributs et de méthodes propres (extrait de programme <a href="#orge5c4d47">3</a>).</li>
<li>la classe <code>Watchdog</code> utilisée lors du tirage</li>
<li>la classe <code>Sac</code>. Un sac contient des symboles identiques.</li>
<li>la classe <code>Pioche</code>. Classe utilisant 9 sacs contenant chacun des symboles identiques tous différents (1 sac avec que des "1", un autre avec que des "2", etc.)</li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;2&nbsp;: </span>la classe Grille fait appel à la classe Case</label><pre class="src src-python" id="org86bed3e"><span class="linenr">208: </span><span style="color: #b22222;"># </span><span style="color: #b22222;">Disposition du conteneur cadre qui contient la grille de sudoku</span>
<span class="linenr">209: </span><span style="color: #a020f0;">for</span> row <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(<span style="color: #a020f0;">self</span>.LARGEUR_GRILLE):
<span class="linenr">210: </span><span style="background-color: #f2f2f2;"> </span>   cadre.rowconfigure(row, weight=1)
<span class="linenr">211: </span><span style="color: #a020f0;">for</span> column <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(<span style="color: #a020f0;">self</span>.LARGEUR_GRILLE):
<span class="linenr">212: </span><span style="background-color: #f2f2f2;"> </span>   cadre.columnconfigure(column, weight=1)
<span class="linenr">213: </span><span style="color: #b22222;"># </span><span style="color: #b22222;">Affichage de la grille de sudoku</span>
<span class="linenr">214: </span><span style="color: #a0522d;">index</span> = 0
<span class="linenr">215: </span><span style="color: #a020f0;">for</span> j <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(<span style="color: #a020f0;">self</span>.LARGEUR_GRILLE):
<span class="linenr">216: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(<span style="color: #a020f0;">self</span>.LARGEUR_GRILLE):
<span class="linenr">217: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   Case(cadre,
<span class="linenr">218: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>index,
<span class="linenr">219: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span><span style="color: #a020f0;">self</span>.get_index_cousines(index),
<span class="linenr">220: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>name=<span style="color: #8b2252;">'{}'</span>.<span style="color: #483d8b;">format</span>(index),
<span class="linenr">221: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>font=<span style="color: #a020f0;">self</span>.police_case,
<span class="linenr">222: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>text=<span style="color: #8b2252;">' '</span>,  <span style="color: #b22222;"># </span><span style="color: #b22222;">cases vides &#224; l'initialisation</span>
<span class="linenr">223: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>disabledforeground=<span style="color: #8b2252;">'saddle brown'</span>,
<span class="linenr">224: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span><span style="color: #b22222;"># </span><span style="color: #b22222;">background pour linux et windows</span>
<span class="linenr">225: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>background=<span style="color: #a020f0;">self</span>.get_couleur_case(
<span class="linenr">226: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>index, <span style="color: #8b2252;">' '</span>),
<span class="linenr">227: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span><span style="color: #b22222;"># </span><span style="color: #b22222;">highlightbackground pour mac osx</span>
<span class="linenr">228: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>highlightbackground=<span style="color: #a020f0;">self</span>.get_couleur_case(
<span class="linenr">229: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>index, <span style="color: #8b2252;">' '</span>)).grid(row=j,
<span class="linenr">230: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>  column=i,
<span class="linenr">231: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>  sticky=<span style="color: #8b2252;">"nsew"</span>)
<span class="linenr">232: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">index</span> += 1
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;3&nbsp;: </span>attributs et méthodes de la classe Grille</label><pre class="src src-python" id="orge5c4d47"><span class="linenr">123: </span>m&#233;thodes:
<span class="linenr">124: </span>---------
<span class="linenr">125: </span>- cacher_jauge_parcours_combinaisons
<span class="linenr">126: </span>- monter_jauge_parcours_combinaisons
<span class="linenr">127: </span>- get_couleur_case
<span class="linenr">128: </span>- get_case
<span class="linenr">129: </span>- get_index_cousines
<span class="linenr">130: </span>- get_index_cousines_en_bloc
<span class="linenr">131: </span>- get_index_cousines_en_colonne
<span class="linenr">132: </span>- get_index_cousines_en_ligne
<span class="linenr">133: </span>- __getitem__
<span class="linenr">134: </span>- __setitem__
<span class="linenr">135: </span>- __len__
<span class="linenr">136: </span>- __repr__
<span class="linenr">137: </span>- basculer_le_bouton_effacerX
<span class="linenr">138: </span>- activer_le_symbole
<span class="linenr">139: </span>- rafraichir_affichage
<span class="linenr">140: </span>- afficher_les_index
<span class="linenr">141: </span>- effacer_grille
<span class="linenr">142: </span>- effacer_case
<span class="linenr">143: </span>- diminuer_jauge_de_remplissage
<span class="linenr">144: </span>- restaurer_pretendants
<span class="linenr">145: </span>- remplir_case
<span class="linenr">146: </span>- augmenter_jauge_de_remplissage
<span class="linenr">147: </span>- reduire_pretendants_des_cousines_de_la_case
<span class="linenr">148: </span>- get_colonne
<span class="linenr">149: </span>- get_ligne
<span class="linenr">150: </span>- get_bloc
<span class="linenr">151: </span>- solveur
<span class="linenr">152: </span>- remplissage
<span class="linenr">153: </span>- placer_pioche_sur_grille
<span class="linenr">154: </span>- placement_est_possible
<span class="linenr">155: </span>- combinaison_existe
<span class="linenr">156: </span>- purger
<span class="linenr">157: </span>- grille_export
<span class="linenr">158: </span>- grille_export_csv
<span class="linenr">159: </span>- grille_import
<span class="linenr">160: </span>- recalculer_les_destinations_envisageables
<span class="linenr">161: </span>- congeler
<span class="linenr">162: </span>- file_load
<span class="linenr">163: </span>- file_save
</pre>
</div>

<p>
Il en va de même pour toutes les fonctions utilisées dans le programme: elles sont, elles aussi, documentées par <i>docstring</i>.
</p>
</div>
</div>

<div id="outline-container-org3d667f1" class="outline-4">
<h4 id="org3d667f1"><span class="section-number-4">2.2.2</span> Multiplateforme</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
Python et tkinter sont théoriquement multiplateformes mais l'apparence est différente suivant la plateforme utilisée.
Globalement tkinter fonctionne mieux sous Linux que sous Windows (on perd le changement d'aspect du bouton au survol de la souris) ou sous mac OSX (idem, de plus le <code>background</code> des boutons doit être obtenu de façon détournée et les fenêtre Toplevel sont mal gérées).
</p>
</div>
</div>
</div>

<div id="outline-container-orgdfbd040" class="outline-3">
<h3 id="orgdfbd040"><span class="section-number-3">2.3</span> La démarche</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-orgef44589" class="outline-4">
<h4 id="orgef44589"><span class="section-number-4">2.3.1</span> Réflexion initiale</h4>
<div class="outline-text-4" id="text-2-3-1">
<ul class="org-ul">
<li>Ne pas consulter de documentation sur les méthodes de résolution pour essayer d'établir une méthode personnelle.</li>
<li>Chaque case vide à des prétendants (symboles que l'ont peut envisager de placer dans la case). La liste des prétendants se réduit au fur et à mesure que la grille se remplit car il faut retirer les symboles placés dans les cases cousines (cases de même ligne, colonne ou bloc). Je me propose donc de gérer les prétendants pour chacune des cases de la grille (d'où le menu d'aide <code>Grille</code> qui fait apparaître les prétendants).</li>
<li>Les symboles sont prélevés dans une pioche qui comporte 9 sacs contenant chacun des symboles identiques. Au départ, il y a 81 destinations possibles pour le premier symbole à placer. Le nombre de destinations possibles pour le second symbole à placer n'est pas forcément de 80 car, si le second symbole est le même que le premier, il ne peut pas être placé dans une case cousine du premier. Je me propose donc de  gérer les destinations pour chacun des neuf symboles au cours de la partie (d'où le menu d'aide <code>Pioche</code> qui fait apparaître les destinations).</li>
</ul>
</div>
</div>
<div id="outline-container-org7c60d7a" class="outline-4">
<h4 id="org7c60d7a"><span class="section-number-4">2.3.2</span> Tirage d'une grille</h4>
<div class="outline-text-4" id="text-2-3-2">
<ul class="org-ul">
<li>aléatoirement, je place le premier '1' dans une des 81 cases, puis le deuxième '1' aléatoirement dans une des destinations restantes, etc. Chaque placement est stocké dans une pile. Si l'on arrive à une impasse (case sans contenu ni prétendants) on remonte dans la pile et on choisi aléatoirement une autre destination envisageable parmi les destinations non testées.</li>
<li>Pour gagner en efficacité, je rajoute un watchdog. Si l'on remonte plus de 4 niveaux dans la pile, le watchdog se déclenche et provoque l'effacement des '1' car placés en premier avec plein de destinations à leur disposition, ils ont peut être adopté une configuration problématique pour le placement des autres symboles. Les '1' sont renvoyés en fin de liste des symboles à placer. Si le watchdog se déclenche à nouveau, les '2' sont à leur tour renvoyés en fin de liste, etc. Pour éviter de rentrer dans un cercle vicieux qui consisterait à renvoyer les symboles en fin de liste les uns après les autre, la profondeur de déclenchement du watchdog augmente au cours des déclenchements.</li>
<li>Réglage du niveau: on part d'une grille pleine obtenue par tirage. Puis on réalise la suppression aléatoire des symboles de la grille qui sont replacés dans la pioche  jusqu'à parvenir au taux de remplissage souhaité par le joueur. Cette méthode ne garantit pas l'unicité de la solution mais, peu importe, car si le joueur parvient à placer tous les symboles sur la grille la victoire lui est accordée (même si la grille pleine tirée au départ était différente).</li>
</ul>
</div>
</div>
<div id="outline-container-orga34c55c" class="outline-4">
<h4 id="orga34c55c"><span class="section-number-4">2.3.3</span> Solveur</h4>
<div class="outline-text-4" id="text-2-3-3">
<ul class="org-ul">
<li>Pas indispensable par pouvoir avoir un jeu fonctionnel (sauf si l'on tient à s'assurer de l'unicité) mais réalisé tout de même.</li>
<li>Première tentative: utiliser le mécanisme du tireur sans watchdog&#x2026; fonctionne en théorie mais la résolution est beaucoup mais alors beaucoup trop longue car des permutations équivalentes sont testées comme étant des propositions différentes .</li>
<li>Solution : s'inspirer du tireur mais utiliser des ensembles de symboles plutôt que de placer un symbole après l'autre.</li>
<li>Par exemple, sur la figure <a href="#org72f709d">15</a> à gauche du <b>X</b> on peut voir que les cinq symboles '8' de la pioche peuvent être placés sur onze cases dont les index sont connus. Grâce à la fonction <code>nCr(n, r)</code> qui retourne le nombre de combinaisons de n objets pris r à r, on calcule le nombre de combinaisons de 5 symboles '8' parmi 11 destinations. Il y en a 462.</li>
<li>On fait de même pour les autres symboles de la pioche. Cela nous permet de déterminer dans quel ordre on va placer les symboles. En commençant par placer ceux qui ont le plus petit nombre de combinaisons cela va diminuer le nombre de destinations possibles pour les autres et donc limiter le nombre de combinaisons possibles pour eux.</li>
<li>On détermine les combinaisons grâce à la fonction <code>combinations</code> du module <code>itertools</code> (programme <a href="#org8bf5935">4</a>) puis on purge la liste en conservant celles qui sont possibles (programme <a href="#org211b721">5</a>). La purge est drastique: pour un nombre de combinaisons allant typiquement de quelques centaines à quelques milliers on se retrouve avec un nombre de combinaisons valables se comptant sur les doigts d'une seule main.</li>
</ul>


<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;4&nbsp;: </span>détermination des combinaisons (classe Sac)</label><pre class="src src-python" id="org8bf5935"><span class="linenr">1173: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">get_combinaisons</span>(<span style="color: #a020f0;">self</span>):
<span class="linenr">1174: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #8b2252;">"""</span>
<span class="linenr">1175: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   G&#233;n&#232;re puis retourne l'ensemble des combinaisons de destinations</span>
<span class="linenr">1176: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   envisageables</span>
<span class="linenr">1177: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   """</span>
<span class="linenr">1178: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #483d8b;">set</span>(combinations(<span style="color: #a020f0;">self</span>.destinations_envisageables,
<span class="linenr">1179: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">self</span>.cardinal))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;5&nbsp;: </span>détermination des combinaisons (classe Grille)</label><pre class="src src-python" id="org211b721"><span class="linenr">815: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">determine_combinaisons</span>(<span style="color: #a020f0;">self</span>, symbole):
<span class="linenr">816: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #8b2252;">"""</span>
<span class="linenr">817: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   G&#233;n&#232;re l'ensemble des combinaisons de destinations envisageables.</span>
<span class="linenr">818: </span>
<span class="linenr">819: </span>
<span class="linenr">820: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   Interroge la pioche puis purge la liste des combinaisons</span>
<span class="linenr">821: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   dont le placement est impossible.</span>
<span class="linenr">822: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   """</span>
<span class="linenr">823: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">combinaisons</span> = <span style="color: #a020f0;">self</span>.pioche[symbole].get_combinaisons()
<span class="linenr">824: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">combinaisons_valables</span> = <span style="color: #483d8b;">set</span>()
<span class="linenr">825: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> combinaison <span style="color: #a020f0;">in</span> combinaisons:
<span class="linenr">826: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> <span style="color: #a020f0;">self</span>.placement_est_possible(
<span class="linenr">827: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">self</span>.destinations_en_place[symbole],
<span class="linenr">828: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #483d8b;">list</span>(combinaison)):
<span class="linenr">829: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   combinaisons_valables.add(combinaison)
<span class="linenr">830: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> combinaisons_valables
<span class="linenr">831: </span>
<span class="linenr">832: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">placement_est_possible</span>(<span style="color: #a020f0;">self</span>, en_place, autres):
<span class="linenr">833: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #8b2252;">"""</span>
<span class="linenr">834: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   Retourne True si les 9 lignes, les 9 colonnes et les 9 blocs 3x3</span>
<span class="linenr">835: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   sont pr&#233;sents parmi les candidats.</span>
<span class="linenr">836: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   Retourne False dans le cas contraire.</span>
<span class="linenr">837: </span><span style="color: #8b2252; background-color: #f2f2f2;"> </span><span style="color: #8b2252;">   """</span>
<span class="linenr">838: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">lignes_requises</span> = <span style="color: #483d8b;">set</span>()
<span class="linenr">839: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">colonnes_requises</span> = <span style="color: #483d8b;">set</span>()
<span class="linenr">840: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">blocs_requis</span> = <span style="color: #483d8b;">set</span>()
<span class="linenr">841: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">destinations</span> = en_place.copy()
<span class="linenr">842: </span><span style="background-color: #f2f2f2;"> </span>   destinations.extend(autres.copy())
<span class="linenr">843: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> destination <span style="color: #a020f0;">in</span> destinations:
<span class="linenr">844: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   lignes_requises.add(<span style="color: #a020f0;">self</span>.get_ligne(destination))
<span class="linenr">845: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   colonnes_requises.add(<span style="color: #a020f0;">self</span>.get_colonne(destination))
<span class="linenr">846: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   blocs_requis.add(<span style="color: #a020f0;">self</span>.get_bloc(destination))
<span class="linenr">847: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> (<span style="color: #483d8b;">len</span>(lignes_requises) == 9) <span style="color: #a020f0;">and</span> (
<span class="linenr">848: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #483d8b;">len</span>(colonnes_requises) == 9) <span style="color: #a020f0;">and</span> (<span style="color: #483d8b;">len</span>(blocs_requis) == 9)
</pre>
</div>


<ul class="org-ul">
<li>Aléatoirement, on place le premier ensemble de symboles dans une des destinations valables et parallèlement on sauvegarde cela dans une pile. On passe ensuite à l'ensemble suivant et on fait de même, etc. Quand on arrive à une impasse (car l'ensemble suivant se retrouve sans destinations valables) on remonte dans la pile et on choisit aléatoirement un autre ensemble parmi l'ensemble des destinations valables.</li>
<li>Ce mécanisme fonctionne parfaitement bien et fini toujours par trouver une solution si celle-ci existe.</li>
<li>Commentaires :
<ul class="org-ul">
<li>Si plusieurs solutions existe la première solution rencontrée est retenue.</li>
<li>Si le solveur est relancé pour résoudre la même grille, il déterminera la solution dans un temps différent à chaque tentative car le parcours des destinations valables se fait de façon aléatoire.</li>
<li>Pour la même raison, si plusieurs solutions existent, le solveur ne tombera pas forcement sur la même à chaque fois.</li>
</ul></li>
<li>Pour gagner en efficacité, le solveur par pile est précédé d'un traitement des single-tons. Tant que la grille possède des cases admettant un seul prétendant, elles sont remplies puis on passe au traitement par pile.</li>
<li>Lorsque le traitement par pile est mis en oeuvre, une jauge de parcours des combinaisons est affichée sous la grille.</li>
</ul>


<div id="orgbca4a61" class="figure">
<p><img src="./images/jauge_de_parcours.png" alt="jauge_de_parcours.png" width="60%" />
</p>
<p><span class="figure-number">Figure&nbsp;16&nbsp;: </span>jauge de parcours sous la grille</p>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgde0fe16" class="outline-2">
<h2 id="orgde0fe16"><span class="section-number-2">3</span> Deuxième version</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org45bef49" class="outline-3">
<h3 id="org45bef49"><span class="section-number-3">3.1</span> L'interface homme-machine</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Cette interface a été réalisée à l'aide de la librairie TKinter. Elle permet :
</p>
<ul class="org-ul">
<li>La visualisation de la grille. Les chiffres de départ sont en noir, ceux placés sont en vert.</li>
<li>De choisir un chiffre (barre verte) pour ensuite pouvoir le placer dans la grille.</li>
<li>D'effacer un chiffre (gomme).</li>
<li>D'effacer tous les chiffres placés (bouton <b>Recommencer</b>).</li>
<li>De résoudre la grille (bouton <b>Résoudre</b>).</li>
<li>De créer une nouvelle grille avec un niveau de difficulté allant de 0 à 20 (bouton Nouveau.</li>
<li>De charger une partie ou de la sauvegarder au format csv (boutons Charger et Enregistrer)</li>
<li>De quitter le jeu (bouton <b>Quitter</b>).</li>
</ul>
</div>

<div id="outline-container-orge440e53" class="outline-4">
<h4 id="orge440e53"><span class="section-number-4">3.1.1</span> Partie affichage : Grille, barre des chiffres et gomme</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
Cette partie est gérée par la fonction Clic
</p>

<p>
Elle analyse la position X,Y du clic pour pouvoir agir en conséquence :
</p>
<ul class="org-ul">
<li>Clic sur la barre verte : le chiffre correspondant est enregistré (dans la variable <code>chiffre</code>)</li>
<li>Clic sur la gomme <code>chiffre</code> est mis à 0 ce qui correspond à une case vide.</li>
<li>Clic sur la grille : si <code>chiffre</code> est entre 0 et 9 et que l'on clique sur une case vide, cette case prend la valeur de <code>chiffre</code>. <code>chiffre</code> est ensuite mis à 10 pour éviter la répétition.</li>
</ul>
</div>
</div>
<div id="outline-container-org9c1431c" class="outline-4">
<h4 id="org9c1431c"><span class="section-number-4">3.1.2</span> Partie menu : boutons</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
Nous avons utilisé des widgets boutons auxquels nous avons associé des fonctions qui sont exécutées lorsque le bouton est cliqué : Résoudre, Recommencer, Charger …
</p>

<p>
Associé au bouton <b>Nouveau</b>, il y a un widget <code>Spinbox</code> qui permet de sélectionner un niveau de difficulté de 0 à 20. Cette valeur passe en paramètre pour la fonction <code>création_aléatoire</code>.
</p>

<p>
Pour les bas niveaux on ne supprime que les des cases que l'on peut retrouver (1 seul prétendant), seul le nombre varie en fonction du niveau.
</p>

<p>
Puis plus on sélectionne un niveau élevé, plus il y a de cases vides, et plus les méthodes pour trouver les chiffres sont complexes. Ceci jusqu'au niveau 19.
</p>

<p>
À niveau 20, on ne génère que des grilles avec 17 cases remplies au départ.
</p>

<p>
Partie Charger Enregistrer : En plus des boutons, on a utilisé un widget <code>Entry</code> qui permet de sélectionner le fichier. Il est inutile de spécifier l'extension .csv qui est rajoutée automatiquement.
</p>

<p>
La fonction Enregistrer enregistre 2 grilles au format .csv : la grille de départ et la grille dans son état actuel. Ceci pour reprendre une partie par exemple.
</p>

<p>
La fonction charger charge la grille initiale si elle est seule ou la grille enregistrée si celle-ci existe.
</p>
</div>
</div>
</div>

<div id="outline-container-orgd34c89e" class="outline-3">
<h3 id="orgd34c89e"><span class="section-number-3">3.2</span> Explications sur les fonctions utilisées</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-org833e38d" class="outline-4">
<h4 id="org833e38d"><span class="section-number-4">3.2.1</span> Intersection</h4>
<div class="outline-text-4" id="text-3-2-1">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;6&nbsp;: </span>intersection de deux listes</label><pre class="src src-python" id="org4842107"><span class="linenr">14: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">intersection_2_listes</span>(L1=[], L2=[]):
<span class="linenr">15: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">result</span> = []
<span class="linenr">16: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> <span style="color: #483d8b;">len</span>(L1)==0 <span style="color: #a020f0;">or</span> <span style="color: #483d8b;">len</span>(L2)==0:
<span class="linenr">17: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> []
<span class="linenr">18: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> n <span style="color: #a020f0;">in</span> L1:
<span class="linenr">19: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> L2:
<span class="linenr">20: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> n == x <span style="color: #a020f0;">and</span> n <span style="color: #a020f0;">not</span> <span style="color: #a020f0;">in</span> result:
<span class="linenr">21: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   result.append(n)
<span class="linenr">22: </span><span style="background-color: #f2f2f2;"> </span>   result.sort()
<span class="linenr">23: </span>
<span class="linenr">24: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> result
</pre>
</div>

<p>
On passe à la fonction <code>intersection_2_listes</code> (programme <a href="#org4842107">6</a>) deux paramètres qui sont des listes (<code>L1</code> et <code>L2</code>).
</p>
<ul class="org-ul">
<li>Si une des deux  liste est vide (on teste si la longueur d'une des liste est nulle) alors l'intersection est vide et l'on renvoie une liste vide</li>
<li>Sinon on compare tous les éléments de la première avec tous ceux de la deuxième et si l'on trouve un élément commun on le rajoute à la liste résultat à condition que l'on ne l'ai pas déjà rajouté. Une fois les comparaisons terminées, on renvoie la liste des éléments communs.</li>
</ul>
</div>
</div>

<div id="outline-container-org430e6be" class="outline-4">
<h4 id="org430e6be"><span class="section-number-4">3.2.2</span> Tests sur les listes</h4>
<div class="outline-text-4" id="text-3-2-2">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;7&nbsp;: </span>présence des 9 chiffres</label><pre class="src src-python" id="orgc66973a"><span class="linenr">27: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">------------   pour savoir si les 9 chiffres sont presents dans une liste de 9</span>
<span class="linenr">28: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">est_complet</span>(a_tester=[1,2,3,4,5,6,7,8,9]):
<span class="linenr">29: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">liste</span>=[1,2,3,4,5,6,7,8,9]  
<span class="linenr">30: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">index</span>=0
<span class="linenr">31: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">while</span> index&lt;9 :
<span class="linenr">32: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> a_tester[index] <span style="color: #a020f0;">in</span> liste :
<span class="linenr">33: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   liste.remove(a_tester[index])
<span class="linenr">34: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">else</span> :
<span class="linenr">35: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">False</span>
<span class="linenr">36: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">index</span>=index+1
<span class="linenr">37: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">True</span>
</pre>
</div>

<p>
La fonction <code>est_complet</code> (programme <a href="#orgc66973a">7</a>) est utilisée pour savoir si dans une liste on a bien tous les nombres de 1 à 9 une fois. Cette fonction renvoie <code>True</code> ou <code>False</code>. 
</p>

<p>
On passe à cette fonction un paramètre qui est la liste :  <code>a_tester</code>.
Pour tous les éléments de la liste, obtenus en faisant varier index de 0 à 8 on teste si les éléments de la liste <code>a_tester</code> sont dans la liste de départ : <code>liste</code>. S'ils le sont on enlève l'élément de la liste de départ <code>liste</code>, sinon on renvoie <code>False</code>. À la fin, si aucun élément ne manque on renvoie <code>True</code>.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;8&nbsp;: </span>pour savoir les chiffres qui restent</label><pre class="src src-python" id="orgae60e75"><span class="linenr">40: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">----------- pour savoir les chiffres qui restent ----------------------------</span>
<span class="linenr">41: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">reste</span>(liste_a_tester):
<span class="linenr">42: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">liste</span>=[1,2,3,4,5,6,7,8,9]
<span class="linenr">43: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> index <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">44: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> liste_a_tester[index] <span style="color: #a020f0;">in</span> liste :
<span class="linenr">45: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   liste.remove(liste_a_tester[index])
<span class="linenr">46: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> liste
</pre>
</div>



<p>
La fonction <code>reste</code> (programme <a href="#orgae60e75">8</a>) est utilisée pour savoir quels sont les éléments qui restent par rapport à la liste des nombres de 1 à 9. Pour la grille de sudoku, cette fonction est utile pour connaître les possibilités qui restent dans une case en éliminant peu à peu tous les éléments qui sont impossibles.
</p>

<p>
On passe à cette fonction un paramètre : la liste : <code>liste_a_tester</code> et la fonction renvoie les éléments restants. On passe en revue tous les éléments de la <code>liste_a_tester</code> et s'ils sont dans la liste on les retire de celle-ci. À la fin la fonction renvoie  ce qui reste de la liste.
</p>
</div>
</div>

<div id="outline-container-orgbb7aba2" class="outline-4">
<h4 id="orgbb7aba2"><span class="section-number-4">3.2.3</span> Les tests de remplissage</h4>
<div class="outline-text-4" id="text-3-2-3">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;9&nbsp;: </span>teste si les 9 chiffres sont presents dans toutes les lignes</label><pre class="src src-python" id="org8f99978"><span class="linenr">49: </span><span style="color: #b22222;"># </span><span style="color: #b22222;">-------------teste si les 9 chiffres sont presents dans toutes les lignes</span>
<span class="linenr">50: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">teste_ligne</span>(grille_a_tester):
<span class="linenr">51: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">j</span>=0
<span class="linenr">52: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">while</span> j&lt;9 :
<span class="linenr">53: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">mot_a_tester</span>=[]
<span class="linenr">54: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9) :
<span class="linenr">55: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   mot_a_tester.append(grille_a_tester[j][i])
<span class="linenr">56: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> <span style="color: #a020f0;">not</span> est_complet(mot_a_tester):
<span class="linenr">57: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">False</span>
<span class="linenr">58: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">j</span>=j+1
<span class="linenr">59: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">True</span>
</pre>
</div>

<p>
La fonction <code>teste_ligne</code> (programme <a href="#org8f99978">9</a>) est utilisée pour savoir si les 9 chiffres sont présents dans les 9 lignes de la grille.
</p>

<p>
On passe en paramètre la grille à tester et la fonction retourne <code>True</code> si les 9 chiffres sont présents dans toutes les lignes ;  elle retourne <code>False</code> sinon. Cette fonction fait appel à la fonction <code>est_complet</code> décrite précédemment. Pour chaque ligne de la grille à tester, on crée une liste (<code>mot_a_tester</code>) est on teste si  cette liste est complète ou non.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;10&nbsp;: </span>teste si les 9 chiffres sont presents dans toutes les colonnes</label><pre class="src src-python" id="org4ddf07e"><span class="linenr">61: </span><span style="color: #b22222;"># </span><span style="color: #b22222;">-------------teste si les 9 chiffres sont presents dans toutes les colonnes</span>
<span class="linenr">62: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">teste_colonne</span>(grille_a_tester):
<span class="linenr">63: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">colonne</span>=0
<span class="linenr">64: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">while</span> colonne&lt;9 :
<span class="linenr">65: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">mot_a_tester</span>=[]
<span class="linenr">66: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> index <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9) :
<span class="linenr">67: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   mot_a_tester.append(grille_a_tester[index][colonne])
<span class="linenr">68: </span>
<span class="linenr">69: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> <span style="color: #a020f0;">not</span> est_complet(mot_a_tester):
<span class="linenr">70: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">False</span>
<span class="linenr">71: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">colonne</span>= colonne + 1
<span class="linenr">72: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">True</span>
</pre>
</div>

<p>
La fonction <code>teste_colonne</code> (programme <a href="#org4ddf07e">10</a>) est  utilisée pour savoir si les 9 chiffres sont présents dans les 9 colonnes de la grille. Même fonction que la précédente pour les colonnes.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;11&nbsp;: </span>teste si les 9 chiffres sont présents dans tous les carrés</label><pre class="src src-python" id="org0a43561"><span class="linenr">75: </span><span style="color: #b22222;"># </span><span style="color: #b22222;">-------------teste si les 9 chiffres sont presents dans tous les carres</span>
<span class="linenr">76: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">teste_carre</span>(grille_a_tester) :
<span class="linenr">77: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">carre</span>=0
<span class="linenr">78: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">while</span> carre&lt;9 :
<span class="linenr">79: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">mot_a_tester</span>=[]
<span class="linenr">80: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9) :
<span class="linenr">81: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   mot_a_tester.append(grille_a_tester[i % 3 + 3 * (carre % 3)][i // 3 + 3 * (carre // 3)])
<span class="linenr">82: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> <span style="color: #a020f0;">not</span> est_complet(mot_a_tester):
<span class="linenr">83: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">False</span>
<span class="linenr">84: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">carre</span>= carre + 1
<span class="linenr">85: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">True</span>
</pre>
</div>

<p>
La fonction <code>teste_carre</code> (programme <a href="#org0a43561">11</a>) est  utilisée pour savoir si les 9 chiffres sont présents dans les 9 carrés de la grille. Même fonction que la précédente pour les carrés.
</p>

<p>
<code>[i % 3 + 3 * (carre % 3)][i // 3 + 3 * (carre // 3)]</code>, permet d'obtenir la position <code>[ligne][colonne]</code> d'un élément de la grille en fonction du numéro du carré et de la position <code>i</code> de l'élément.
</p>


<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;12&nbsp;: </span>teste si les 9 chiffres sont presents LCC</label><pre class="src src-python" id="org7881b54"><span class="linenr">87: </span><span style="color: #b22222;"># </span><span style="color: #b22222;">-------------teste si les 9 chiffres sont presents LCC</span>
<span class="linenr">88: </span>
<span class="linenr">89: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">test_complet</span>(grille_a_tester):
<span class="linenr">90: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> <span style="color: #a020f0;">not</span> teste_ligne(grille_a_tester):
<span class="linenr">91: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">False</span>
<span class="linenr">92: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">elif</span> <span style="color: #a020f0;">not</span> teste_colonne(grille_a_tester):
<span class="linenr">93: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">False</span>
<span class="linenr">94: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">elif</span> <span style="color: #a020f0;">not</span> teste_carre(grille_a_tester):
<span class="linenr">95: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">False</span>
<span class="linenr">96: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">else</span> :
<span class="linenr">97: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">True</span>
</pre>
</div>

<p>
La fonction <code>test_complet</code> (programme <a href="#org7881b54">12</a>) utilise les 3 fonctions précédentes.
On lui passe en paramètre la grille à tester. Elle teste successivement si les 9 chiffres sont présents :
</p>
<ul class="org-ul">
<li>dans toutes les lignes</li>
<li>dans toutes les colonnes</li>
<li>dans tous les carrés</li>
</ul>
<p>
Elle retourne <code>True</code> si tous les chiffres sont présents dans toutes les lignes, toutes les colonnes et tous les carrés.  Sinon elle retourne <code>False</code>.
</p>

<p>
Cette fonction permet de savoir si la grille de sudoku est bien remplie.
</p>
</div>
</div>

<div id="outline-container-org4c10e9c" class="outline-4">
<h4 id="org4c10e9c"><span class="section-number-4">3.2.4</span> Tests pour la résolution</h4>
<div class="outline-text-4" id="text-3-2-4">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;13&nbsp;: </span>quels sont les chiffres qui restent à mettre dans une  colonne</label><pre class="src src-python" id="orgeb5b8e3"><span class="linenr">100: </span><span style="color: #b22222;"># </span><span style="color: #b22222;">-------------quels sont les chiffres qui restent a mettre dans une  colonne</span>
<span class="linenr">101: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">reste_colonne</span>(grille_a_tester,colonne):
<span class="linenr">102: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">mot_a_tester</span>=[]
<span class="linenr">103: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9) :
<span class="linenr">104: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   mot_a_tester.append(grille_a_tester[i][colonne])
<span class="linenr">105: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> reste(mot_a_tester)
</pre>
</div>

<p>
La fonction <code>reste_colonne</code> (programme <a href="#orgeb5b8e3">13</a>) va fournir la liste des éléments qui rentent à placer dans une colonne.
</p>

<p>
On lui passe en paramètre la grille à tester et un numéro de colonne. Cette fonction crée une liste constituée des éléments de la colonne spécifiée : <code>mot_a_tester</code>, elle retourne la liste des éléments  non encore placés en utilisant la fonction reste vue précédemment. 
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;14&nbsp;: </span>quels sont les chiffres qui restent à mettre dans une ligne ou un carré</label><pre class="src src-python" id="org3a5e35c"><span class="linenr">108: </span><span style="color: #b22222;"># </span><span style="color: #b22222;">-------------quels sont les chiffres qui restent a mettre dans une ligne</span>
<span class="linenr">109: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">reste_ligne</span>(grille_a_tester,ligne):
<span class="linenr">110: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">mot_a_tester</span>=[]
<span class="linenr">111: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> index <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9) :
<span class="linenr">112: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   mot_a_tester.append(grille_a_tester[ligne][index])
<span class="linenr">113: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> reste(mot_a_tester)
<span class="linenr">114: </span>
<span class="linenr">115: </span><span style="color: #b22222;"># </span><span style="color: #b22222;">-------------quels sont les chiffres qui restent a mettre dans le carre</span>
<span class="linenr">116: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">reste_carre</span>(grille_a_tester,ligne,colonne):
<span class="linenr">117: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">mot_a_tester</span>=[]
<span class="linenr">118: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">position_carre</span>=3*(ligne//3)+colonne//3
<span class="linenr">119: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> index <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9) :
<span class="linenr">120: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   mot_a_tester.append(grille_a_tester[index // 3 + 3 * (position_carre // 3)][index % 3 + 3 * (position_carre % 3)])
<span class="linenr">121: </span>
<span class="linenr">122: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> reste(mot_a_tester)
</pre>
</div>


<p>
On réalise (programme <a href="#org3a5e35c">14</a>) les fonctions <code>reste-ligne</code> et <code>reste_carré</code> qui respectivement vont fournir la liste des éléments qui restent à placer dans une ligne et la liste des éléments qui rentent à placer dans un carré.
</p>

<p>
On passe en paramètre à la fonction <code>reste_carre</code> :
</p>
<ul class="org-ul">
<li>la grille à tester</li>
<li>la ligne d'un élément</li>
<li>la colonne de l'élément.</li>
</ul>
<p>
On crée une liste vide : <code>mot_a_tester</code>[]=. On détermine la position du carré en fonction de la ligne et de la colonne de l'élément : <code>position_carre=3*(ligne//3)+colonne//3</code>. Pour tous les éléments du carré trouvé, on ajoute à la liste <code>mot_a_tester</code> tous les éléments du carré. On renvoie le reste en utilisant la fonction reste (programme <a href="#orgae60e75">8</a>).
</p>


<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;15&nbsp;: </span>finalement aux coordonnées données que reste-t-il comme chiffre possible ?</label><pre class="src src-python" id="org2626529"><span class="linenr">125: </span><span style="color: #b22222;"># </span><span style="color: #b22222;">-------------- finalement aux coordonnees donnees que reste-t-il comme chiffre possible</span>
<span class="linenr">126: </span>
<span class="linenr">127: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">reste_possible</span>(grille_a_tester,ligne,colonne):
<span class="linenr">128: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> (grille_a_tester[ligne][colonne]&gt;0) :
<span class="linenr">129: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> []
<span class="linenr">130: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste1</span>=reste_ligne(grille_a_tester,ligne)
<span class="linenr">131: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste2</span>=reste_colonne(grille_a_tester,colonne)
<span class="linenr">132: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste3</span>=reste_carre(grille_a_tester,ligne,colonne)
<span class="linenr">133: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste4</span> = intersection_2_listes(reste1,reste2)
<span class="linenr">134: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste</span>=intersection_2_listes(reste4,reste3)
<span class="linenr">135: </span>
<span class="linenr">136: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> reste
</pre>
</div>

<p>
La fonction <code>reste_possible</code> (programme <a href="#org2626529">15</a>) va déterminer pour une case du sudoku quels sont les candidats possibles.
</p>

<p>
On passe en paramètre:
</p>
<ul class="org-ul">
<li>la grille à tester</li>
<li>la ligne d'un élément</li>
<li>la colonne de l'élément.</li>
</ul>

<p>
On détermine quels sont les candidats possibles pour une case de la grille (dans la ligne, dans la colonne et dans le carré). On fait ensuite l'intersection ce ces 3 ensembles pour pouvoir retourner le reste des candidats possibles.
</p>

<p>
Si la case est déjà remplie (valeur non nulle), on retourne une liste vide.
</p>
</div>
</div>

<div id="outline-container-orgdd2193b" class="outline-4">
<h4 id="orgdd2193b"><span class="section-number-4">3.2.5</span> Fonctions pour la création des grilles (grilles simples par soustraction)</h4>
<div class="outline-text-4" id="text-3-2-5">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;16&nbsp;: </span>reste possible pour la création des grilles</label><pre class="src src-python" id="org816fa27"><span class="linenr">140: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">reste_possible_creation</span>(grille_a_tester,ligne,colonne):
<span class="linenr">141: </span>
<span class="linenr">142: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste1</span>=reste_ligne(grille_a_tester,ligne)
<span class="linenr">143: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste2</span>=reste_colonne(grille_a_tester,colonne)
<span class="linenr">144: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste3</span>=reste_carre(grille_a_tester,ligne,colonne)
<span class="linenr">145: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste4</span> = intersection_2_listes(reste1,reste2)
<span class="linenr">146: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste</span>=intersection_2_listes(reste4,reste3)
<span class="linenr">147: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> reste
</pre>
</div>

<p>
La fonction <code>reste_possible_creation</code> (programme <a href="#org816fa27">16</a>) est la même fonction que la précédente, mais qui ne renvoie pas une liste vide lorsque l'élément est présent. 
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;17&nbsp;: </span>inverser 2 chiffres d'une grille</label><pre class="src src-python" id="orga64be5c"><span class="linenr">154: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">inverser_nombres_grille</span>(tab,nombre1,nombre2):
<span class="linenr">155: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">156: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> j <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">157: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">fait</span>=<span style="color: #008b8b;">False</span>
<span class="linenr">158: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> tab[i][j]==nombre1 <span style="color: #a020f0;">and</span> <span style="color: #a020f0;">not</span> fait:
<span class="linenr">159: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tab[i][j]=nombre2
<span class="linenr">160: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">fait</span>=<span style="color: #008b8b;">True</span>
<span class="linenr">161: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> tab[i][j]==nombre2 <span style="color: #a020f0;">and</span> <span style="color: #a020f0;">not</span> fait:
<span class="linenr">162: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tab[i][j]=nombre1
<span class="linenr">163: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">fait</span>=<span style="color: #008b8b;">True</span>
<span class="linenr">164: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> tab
</pre>
</div>

<p>
La fonction <code>inverser_nombres_grille</code> (programme <a href="#orga64be5c">17</a>) sert à inverser 2 chiffres d'une grille. Ceci permet de créer une grille différente de celle d'origine.
</p>

<p>
On passe en paramètre :
</p>
<ul class="org-ul">
<li>le nom de la grille (<code>tab</code>)</li>
<li>les deux chiffres à échanger</li>
</ul>
<p>
La fonction renvoie la grille avec les deux chiffres échangés.
Dans la grille, on passe en revue toutes les lignes (indice <code>i</code>) et toutes les colonnes (indice <code>j</code>). Si dans une case on trouve un des deux chiffres on l'échange avec l'autre. La variable <code>fait</code> est mise à <code>False</code> au départ et elle passe à <code>True</code> dès que l'échange a été fait, ceci pour ne pas échanger deux fois le contenu de la case lorsque l'on tombe sur <code>nombre1</code>.
</p>

<p>
Cette fonction n'est plus utilisée car la fonction <code>melange_nombre_grille</code> (programme <a href="#org9e329d5">19</a>) permet de mélanger tous les nombres d'un seul coup.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;18&nbsp;: </span>inverser 2 lignes ou 2 colonnes</label><pre class="src src-python" id="org77593fe"><span class="linenr">166: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">________________inverser 2 colonnes ________________________________</span>
<span class="linenr">167: </span>
<span class="linenr">168: </span>
<span class="linenr">169: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">inverser_colonnes</span>(tab,colonne1,colonne2):
<span class="linenr">170: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> colonne1//3==colonne2//3:
<span class="linenr">171: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">172: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">temp</span>=tab[i][colonne1]
<span class="linenr">173: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tab[i][colonne1]=tab[i][colonne2]
<span class="linenr">174: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tab[i][colonne2]=temp
<span class="linenr">175: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> tab
<span class="linenr">176: </span>
<span class="linenr">177: </span>
<span class="linenr">178: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">________________inverser 2 lignes ________________________________</span>
<span class="linenr">179: </span>
<span class="linenr">180: </span>
<span class="linenr">181: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">inverser_lignes</span>(tab,ligne1,ligne2):
<span class="linenr">182: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> ligne1//3==ligne2//3:
<span class="linenr">183: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">184: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">temp</span>=tab[ligne1][i]
<span class="linenr">185: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tab[ligne1][i]=tab[ligne2][i]
<span class="linenr">186: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tab[ligne2][i]=temp
<span class="linenr">187: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> tab
</pre>
</div>

<p>
Les fonctions <code>inverser_colonnes</code> et <code>inverser_lignes</code> (programme <a href="#org77593fe">18</a>) permettent d'inverser 2 colonnes ou 2 lignes d'une grille. Ceci permet de créer une grille différente de celle d'origine.
</p>

<p>
On passe en paramètre :
</p>
<ul class="org-ul">
<li>le nom de la grille (<code>tab</code>)</li>
<li>les deux lignes ou colonnes à échanger</li>
</ul>

<p>
La fonction renvoie la grille avec les deux lignes (ou colonnes) échangées.
</p>

<p>
La ligne:     = if colonne1//3==colonne2//3: (if ligne1//3==ligne2//3: )= permet de vérifier que l'échange se fait dans les mêmes carrés, sinon on créerait une grille fausse.
</p>

<p>
Pour le reste on fait simplement un échange en passant par une variable temporaire <code>temp</code>.
 
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;19&nbsp;: </span>mélange aléatoire des nombres d'une grille</label><pre class="src src-python" id="org9e329d5"><span class="linenr">140: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">reste_possible_creation</span>(grille_a_tester,ligne,colonne):
<span class="linenr">141: </span>
<span class="linenr">142: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste1</span>=reste_ligne(grille_a_tester,ligne)
<span class="linenr">143: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste2</span>=reste_colonne(grille_a_tester,colonne)
<span class="linenr">144: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste3</span>=reste_carre(grille_a_tester,ligne,colonne)
<span class="linenr">145: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste4</span> = intersection_2_listes(reste1,reste2)
<span class="linenr">146: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">reste</span>=intersection_2_listes(reste4,reste3)
<span class="linenr">147: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> reste
</pre>
</div>

<p>
La fonction <code>melange_nombre_grille</code> (programme <a href="#org9e329d5">19</a>) permet de mélanger aléatoirement les nombres d'une grille ce qui permet de créer des grilles différentes à partir d'une grille de départ.
</p>

<p>
On part d'une liste <code>chiffres_melanges</code> : <code>[1,2,3,4,5,6,7,8,9]</code> que l'on mélange aléatoirement avec la fonction <code>shuffle</code>, son ordre est donc quelconque. On passe en revue à l'aide de 2 boucles <code>for</code> imbriquées (indices <code>i</code> et <code>j</code>) tous les éléments de la grille <code>tab</code> et on remplace le chiffre de départ  si celui-ci est positif (le zéro correspond à une case vide) par le contenu du tableau <code>chiffres_melanges</code> dont le rang est le chiffre de départ -1 (pour commencer les indices à 0).
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;20&nbsp;: </span>mélange aléatoire 3 grandes colonnes</label><pre class="src src-python" id="org852e681"><span class="linenr">204: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">_________________melange aleatoir 3 grandes colonnes__________</span>
<span class="linenr">205: </span>
<span class="linenr">206: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">change_3_col</span>(tableau):
<span class="linenr">207: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">a</span> = <span style="color: #483d8b;">range</span>(3)
<span class="linenr">208: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">b</span> = [0,1,2]
<span class="linenr">209: </span><span style="background-color: #f2f2f2;"> </span>   shuffle(b)
<span class="linenr">210: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">tab_temp</span>=[]
<span class="linenr">211: </span>
<span class="linenr">212: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">213: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tab_temp.append(tableau[lign][:])  
<span class="linenr">214: </span>
<span class="linenr">215: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> colon <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">216: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">217: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tableau[lign][colon]=tab_temp[lign][(b[colon//3]-a[colon//3])*3+colon]
<span class="linenr">218: </span>
<span class="linenr">219: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> tableau
</pre>
</div>

<p>
La fonction <code>change_3_col</code> (programme <a href="#org852e681">20</a>) permet de mélanger aléatoirement 3 grandes colonnes ce qui permet de créer des grilles différentes à partir d'une grille de départ.
</p>

<p>
On part d'un tableau (grille de sudoku), on crée 2 listes contenant 0, 1, 2 : 
</p>
<ul class="org-ul">
<li><code>a</code> dans l'ordre</li>
<li><code>b</code> dans un ordre aléatoire après l'utilisation de la fonction shuffle.</li>
</ul>
<p>
On recopie le tableau dans un tableau temporaire : <code>tab_temp</code>
Puis on recopie ce tableau temporaire dans le tableau de départ en mélangeant les 3 grandes colonnes.  J'utilise pour cela la fonction <code>[(b[colon//3]-a[colon//3])*3+colon]</code> qui va permettre de mélanger les colonnes par groupes  de 3 : on pourra par exemple obtenir 345012678 ce qui va permettre d'échanger les colonnes 012 avec les 345 la colonne 678 restant en place.
Il y a 3! = 6 combinaisons possibles.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;21&nbsp;: </span>mélange aléatoire 3 grandes lignes</label><pre class="src src-python" id="org5150aff"><span class="linenr">224: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">_________________melange aleatoir 3 grandes lignes____________________</span>
<span class="linenr">225: </span>
<span class="linenr">226: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">change_3_lign</span>(tableau):
<span class="linenr">227: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">a</span> = <span style="color: #483d8b;">range</span>(3)
<span class="linenr">228: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">b</span> = [0,1,2]
<span class="linenr">229: </span><span style="background-color: #f2f2f2;"> </span>   shuffle(b)
<span class="linenr">230: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">tab_temp</span>=[]
<span class="linenr">231: </span>
<span class="linenr">232: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">233: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tab_temp.append(tableau[lign][:])
<span class="linenr">234: </span>
<span class="linenr">235: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">236: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> colon <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">237: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tableau[lign][colon]=tab_temp[(b[lign//3]-a[lign//3])*3+lign][colon]
<span class="linenr">238: </span>
<span class="linenr">239: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> tableau
</pre>
</div>

<p>
La fonction <code>change_3_lign</code> (programme <a href="#org5150aff">21</a>) permet de mélanger aléatoirement 3 grandes lignes ce qui permet de créer des grilles différentes à partir d'une grille de départ.
C'est la même fonction que la précédente, mais appliquée aux lignes à la place des colonnes.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;22&nbsp;: </span>mélange aléatoire de 3 petites colonnes</label><pre class="src src-python" id="org308c937"><span class="linenr">245: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">change_3_petites_col</span>(tableau):
<span class="linenr">246: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">b</span> = [0,1,2]
<span class="linenr">247: </span>
<span class="linenr">248: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">tab_temp</span>=[]
<span class="linenr">249: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">250: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tab_temp.append(tableau[lign][:])
<span class="linenr">251: </span>
<span class="linenr">252: </span><span style="background-color: #f2f2f2;"> </span>   shuffle(b)
<span class="linenr">253: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> colon <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(3):
<span class="linenr">254: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">255: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tableau[lign][colon]=tab_temp[lign][b[colon]]
<span class="linenr">256: </span>
<span class="linenr">257: </span><span style="background-color: #f2f2f2;"> </span>   shuffle(b)
<span class="linenr">258: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> colon <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(3,6):
<span class="linenr">259: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">260: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tableau[lign][colon]=tab_temp[lign][b[colon-3]+3]
<span class="linenr">261: </span>
<span class="linenr">262: </span><span style="background-color: #f2f2f2;"> </span>   shuffle(b)
<span class="linenr">263: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> colon <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(6,9):
<span class="linenr">264: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">265: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tableau[lign][colon]=tab_temp[lign][b[colon-6]+6]
<span class="linenr">266: </span>
<span class="linenr">267: </span>
<span class="linenr">268: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> tableau
</pre>
</div>

<p>
La fonction <code>change_3_petites_col</code> (programme <a href="#org308c937">22</a>) permet d'échanger aléatoirement les 3 petites colonnes des 3 grandes colonnes d'une grille. Ceci permet de créer des grilles différentes à partir d'une grille de départ.
</p>

<p>
On commence par copier le tableau (<code>grille</code>) dans un tableau temporaire. On mélange <code>b</code> avec la fonction <code>shuffle</code>. On recopie les 3 premières colonnes en changeant l'ordre de celles-ci (on remplace le numéro de colonne par la valeur de b d'indice le numéro en question). 
</p>

<p>
Idem avec les 3 colonnes suivantes et les 3 dernières.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;23&nbsp;: </span>mélange aléatoire de 3 petites lignes</label><pre class="src src-python" id="org86e272c"><span class="linenr">273: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">change_3_petites_lignes</span>(tableau):
<span class="linenr">274: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">b</span> = [0,1,2]
<span class="linenr">275: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">tab_temp</span>=[]
<span class="linenr">276: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">277: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tab_temp.append(tableau[lign][:])
<span class="linenr">278: </span>
<span class="linenr">279: </span><span style="background-color: #f2f2f2;"> </span>   shuffle(b)
<span class="linenr">280: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(3):
<span class="linenr">281: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> colon <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">282: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tableau[lign][colon]=tab_temp[b[lign]][colon]
<span class="linenr">283: </span>
<span class="linenr">284: </span><span style="background-color: #f2f2f2;"> </span>   shuffle(b)
<span class="linenr">285: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(3,6):
<span class="linenr">286: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> colon <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">287: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tableau[lign][colon]=tab_temp[b[lign-3]+3][colon]
<span class="linenr">288: </span>
<span class="linenr">289: </span><span style="background-color: #f2f2f2;"> </span>   shuffle(b)
<span class="linenr">290: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(6,9):
<span class="linenr">291: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> colon <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">292: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tableau[lign][colon]=tab_temp[b[lign-6]+6][colon]
<span class="linenr">293: </span>
<span class="linenr">294: </span>
<span class="linenr">295: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> tableau
</pre>
</div>

<p>
Idem mélange des 3 petites colonnes, mais pour les lignes.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;24&nbsp;: </span>supprime la valeur d'une case aléatoirement</label><pre class="src src-python" id="orga1b11f5"><span class="linenr">297: </span><span style="color: #b22222;"># </span><span style="color: #b22222;">______________pour la creation : supprime la valeur d'une case aleatoirement</span>
<span class="linenr">298: </span>
<span class="linenr">299: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">supprimer_nombre_simple</span>(tableau):
<span class="linenr">300: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">lign</span>=randint(0,8)
<span class="linenr">301: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">colon</span>=randint(0,8)
<span class="linenr">302: </span>
<span class="linenr">303: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> (tableau[lign][colon] != 0) <span style="color: #a020f0;">and</span>  <span style="color: #483d8b;">len</span>(reste_possible_creation(tableau,lign,colon))==0:
<span class="linenr">304: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tableau[lign][colon]=0
<span class="linenr">305: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> tableau
<span class="linenr">306: </span>
<span class="linenr">307: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">supprimer_nombre</span>(tableau):
<span class="linenr">308: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">lign</span>=randint(0,8)
<span class="linenr">309: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">colon</span>=randint(0,8)
<span class="linenr">310: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">copie</span>=[[0]*9 <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9)]
<span class="linenr">311: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">312: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">copie</span>[i]=tableau[i][:]
<span class="linenr">313: </span><span style="background-color: #f2f2f2;"> </span>   copie[lign][colon]=0
<span class="linenr">314: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> teste_ligne(resolution(copie)):
<span class="linenr">315: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   tableau[lign][colon]=0
<span class="linenr">316: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> tableau
</pre>
</div>



<p>
Les fonctions <code>supprimer_nombre_simple</code> et <code>supprimer_nombre</code> (<a href="#orga1b11f5">24</a>) peuvent être utilisées pour la création de grilles nouvelles.
</p>

<p>
On leur passe en paramètre une grille complète ou partiellement complète elles renvoient cette même grille avec eventuellement une case mise à 0.
</p>

<p>
La fonction <code>supprimer_nombre_simple</code> :
</p>
<ul class="org-ul">
<li>Tire 2 coordonnées (ligne, colonne)  aléatoirement entre 0 et 8</li>
<li>Si à ces coordonnées il y a une valeur que l'on peut trouver directement, on la supprime de la</li>
</ul>
<p>
grille. Cette fonction permet de générer des grilles pour débutants.
</p>

<p>
La fonction <code>supprimer_nombre</code> :
</p>
<ul class="org-ul">
<li>Tire 2 coordonnées (ligne, colonne)  aléatoirement entre 0 et 8</li>
<li>On crée une copie de la grille</li>
<li>On supprime la valeur de la case tirée aléatoirement sur la copie</li>
<li>On essaie de résoudre (par les fonctions de résolution) cette copie de grille.</li>
<li>Si on a pu résoudre, on enlève la valeur de la grille et on la retourne.</li>
</ul>


<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;25&nbsp;: </span>création de grille</label><pre class="src src-python" id="org059cedc"><span class="linenr">323: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">----------------------   CREATION GRILLE   ---------------------------------      </span>
<span class="linenr">324: </span>
<span class="linenr">325: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">creation_aleatoire</span>(grille_s,grille_d,difficulte) :
<span class="linenr">326: </span>
<span class="linenr">327: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">grille_s</span>=melange_nombre_grille(grille_s)
<span class="linenr">328: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">grille_s</span>=change_3_col(grille_s)
<span class="linenr">329: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">grille_s</span>=change_3_lign(grille_s)
<span class="linenr">330: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">grille_s</span>=change_3_petites_col(grille_s)
<span class="linenr">331: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">grille_s</span>=change_3_petites_lignes(grille_s)
<span class="linenr">332: </span>
<span class="linenr">333: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> difficulte&lt;5 :
<span class="linenr">334: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(10+8*difficulte):
<span class="linenr">335: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>  supprimer_nombre_simple(grille_s)
<span class="linenr">336: </span>
<span class="linenr">337: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">elif</span> difficulte&lt;10 :
<span class="linenr">338: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(20):
<span class="linenr">339: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   supprimer_nombre_simple(grille_s)
<span class="linenr">340: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> j <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(difficulte*5):
<span class="linenr">341: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   supprimer_nombre(grille_s)
<span class="linenr">342: </span>
<span class="linenr">343: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">elif</span> difficulte&lt;18 :
<span class="linenr">344: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(30+difficulte*3):
<span class="linenr">345: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   supprimer_nombre(grille_s)
<span class="linenr">346: </span>
<span class="linenr">347: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">elif</span> difficulte&lt;20 :
<span class="linenr">348: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(30+difficulte*3):
<span class="linenr">349: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   supprimer_nombre(grille_s)
<span class="linenr">350: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">351: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> j <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">352: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> grille_s[i][j]!=0:
<span class="linenr">353: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">copie</span>=[[0]*9 <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9)]
<span class="linenr">354: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">355: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">copie</span>[i]=grille_s[i][:]
<span class="linenr">356: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   copie[i][j]=0
<span class="linenr">357: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> teste_ligne(resolution(copie)):
<span class="linenr">358: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   grille_s[i][j]=0
<span class="linenr">359: </span>
<span class="linenr">360: </span>
<span class="linenr">361: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">else</span> :
<span class="linenr">362: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">grille17</span>=[[1,0,0,0,0,0,5,2,0],
<span class="linenr">363: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span> [0,0,0,0,7,8,0,0,0],
<span class="linenr">364: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span> [0,0,0,0,0,0,6,0,0],
<span class="linenr">365: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span> [0,9,0,0,4,0,0,0,0],
<span class="linenr">366: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span> [0,0,0,5,0,0,1,0,0],
<span class="linenr">367: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span> [0,7,0,0,0,0,0,0,0],
<span class="linenr">368: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span> [0,0,6,2,0,0,0,0,0],
<span class="linenr">369: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span> [0,4,0,0,0,0,0,7,8],
<span class="linenr">370: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span> [0,0,0,0,0,0,0,0,3]]
<span class="linenr">371: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">372: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> j <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">373: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   grille_s[i][j]=grille17[i][j]
<span class="linenr">374: </span>
<span class="linenr">375: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">grille_s</span>=melange_nombre_grille(grille_s)
<span class="linenr">376: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">grille_s</span>=change_3_col(grille_s)
<span class="linenr">377: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">grille_s</span>=change_3_lign(grille_s)
<span class="linenr">378: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">grille_s</span>=change_3_petites_col(grille_s)
<span class="linenr">379: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">grille_s</span>=change_3_petites_lignes(grille_s)
<span class="linenr">380: </span>
<span class="linenr">381: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9) :
<span class="linenr">382: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> j <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">383: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   grille_d[i][j] = grille_s[i][j]
<span class="linenr">384: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> grille_s,grille_d
</pre>
</div>

<p>
La fonction <code>creation_aleatoire</code> (programme <a href="#org059cedc">25</a>) permet de créer une grille aléatoirement :
</p>
<ul class="org-ul">
<li>On part d'une grille quelconque (pleine ou partiellement remplie)</li>
<li>On utilise les fonctions de mélange (chiffres, colonnes, lignes, petites colonnes et petites lignes) pour créer une grille différente.</li>
<li>On supprime ensuite (avec fonction <code>supprimer_nombre</code>) des valeurs de la grille</li>
<li>On recopie la grille créée pour avoir la grille de départ.</li>
<li>Et l'on renvoie ensuite ces 2 mêmes grilles. La grille de départ aura une couleur d'affichage différente et ne pourra pas être effacée.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgad7dade" class="outline-3">
<h3 id="orgad7dade"><span class="section-number-3">3.3</span> Les fonctions de résolution</h3>
<div class="outline-text-3" id="text-3-3">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;26&nbsp;: </span>grille des possibles</label><pre class="src src-python" id="org1487b13"><span class="linenr">395: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">grille_des_possibles</span>(tab):
<span class="linenr">396: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">gdp</span>=[]
<span class="linenr">397: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> ligne <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">398: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">ldp</span>=[]
<span class="linenr">399: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> colonne <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">400: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   ldp.append(reste_possible(tab,ligne,colonne))
<span class="linenr">401: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   gdp.append(ldp)
<span class="linenr">402: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> gdp
</pre>
</div>

<p>
La fonction <code>grille_des_possibles</code> (programme <a href="#org1487b13">26</a>) en elle-même ne résout rien, mais elle crée un tableau gdp image de la grille de départ qui au lieu de contenir les valeurs contient la liste des prétendants.
</p>

<p>
Pour chaque ligne de la grille, on crée une ligne des possibles (ldp)  contenant tous les restes possibles de la ligne et on l'ajoute à la grilles des possibles (gdp). Lorsque celle-ci est pleine, la fonction la retourne.
</p>
</div>

<div id="outline-container-org6d3201f" class="outline-4">
<h4 id="org6d3201f"><span class="section-number-4">3.3.1</span> Première fonction de résolution:  <code>ou_le_nombre_peut_etre</code></h4>
<div class="outline-text-4" id="text-3-3-1">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;27&nbsp;: </span>Première fonction de résolution</label><pre class="src src-python" id="org85302bc"><span class="linenr">405: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">ou_le_nombre_peut_etre</span>(tab,nombre):
<span class="linenr">406: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">possible</span> = [[1]*9 <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9)]
<span class="linenr">407: </span>
<span class="linenr">408: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">remplissage matrice des possibles</span>
<span class="linenr">409: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">----- singleton cache -------------------------------------------------  </span>
<span class="linenr">410: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">411: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> j <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9) :
<span class="linenr">412: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> tab[i][j]!=0:
<span class="linenr">413: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   possible[i][j]=0
<span class="linenr">414: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> tab[i][j]==nombre:
<span class="linenr">415: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">carre</span>=3*(i//3)+j//3
<span class="linenr">416: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> k <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">417: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   possible[i][k]=0
<span class="linenr">418: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   possible[k][j]=0
<span class="linenr">419: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   possible[3*(carre//3)+k//3][3*(carre%3)+k%3]=0
<span class="linenr">420: </span>
<span class="linenr">421: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">______ singleton cache fin       ______________________________________</span>
<span class="linenr">422: </span>
<span class="linenr">423: </span>
<span class="linenr">424: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">--------------Elimination indirecte-----------------------------------</span>
<span class="linenr">425: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> carre <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">426: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">debut_ligne</span>=10
<span class="linenr">427: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">fin_ligne</span>=11
<span class="linenr">428: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(3) :
<span class="linenr">429: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> j <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(3):
<span class="linenr">430: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> possible[3*(carre//3) +i][3*(carre%3)+j]==1 <span style="color: #a020f0;">and</span> debut_ligne==10:
<span class="linenr">431: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">debut_ligne</span> = 3*(carre//3) +i
<span class="linenr">432: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">elif</span> possible[3*(carre//3) +i][3*(carre%3)+j]==1:
<span class="linenr">433: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">fin_ligne</span> = 3*(carre//3) +i
<span class="linenr">434: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> debut_ligne==fin_ligne :
<span class="linenr">435: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> j <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">436: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> j!=3*(carre%3) <span style="color: #a020f0;">and</span> j!=3*(carre%3)+1 <span style="color: #a020f0;">and</span> j!=3*(carre%3)+2 :
<span class="linenr">437: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   possible[debut_ligne][j]=0
<span class="linenr">438: </span>
<span class="linenr">439: </span>
<span class="linenr">440: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> carre <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">441: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">debut_colonne</span>=10
<span class="linenr">442: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">fin_colonne</span>=11
<span class="linenr">443: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> j <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(3) :
<span class="linenr">444: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(3):
<span class="linenr">445: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> possible[3*(carre//3) +i][3*(carre%3)+j]==1 <span style="color: #a020f0;">and</span> debut_colonne==10:
<span class="linenr">446: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">debut_colonne</span> = 3*(carre%3) +j
<span class="linenr">447: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">elif</span> possible[3*(carre//3) +i][3*(carre%3)+j]==1:
<span class="linenr">448: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">fin_colonne</span> = 3*(carre%3) +j
<span class="linenr">449: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> debut_colonne==fin_colonne :
<span class="linenr">450: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">451: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> i!=3*(carre//3) <span style="color: #a020f0;">and</span> i!=3*(carre//3)+1 <span style="color: #a020f0;">and</span> i!=3*(carre//3)+2 :
<span class="linenr">452: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   possible[i][debut_colonne]=0 
<span class="linenr">453: </span>
<span class="linenr">454: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">Elimination indirecte fin _____________________________________________________    </span>
<span class="linenr">455: </span>
<span class="linenr">456: </span>
<span class="linenr">457: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">analyse des lignes</span>
<span class="linenr">458: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> lign <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">459: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">resultat</span>=[]
<span class="linenr">460: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">nombre_de_1</span>=0
<span class="linenr">461: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> colon <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">462: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> possible[lign][colon]==1:
<span class="linenr">463: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   resultat.append([lign,colon])
<span class="linenr">464: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">nombre_de_1</span>+=1
<span class="linenr">465: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> nombre_de_1==1 :
<span class="linenr">466: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> resultat
<span class="linenr">467: </span>
<span class="linenr">468: </span>
<span class="linenr">469: </span>
<span class="linenr">470: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">analyse des colonnes</span>
<span class="linenr">471: </span>
<span class="linenr">472: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> j <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">473: </span>
<span class="linenr">474: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">resultat</span>=[]
<span class="linenr">475: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">nombre_de_1</span>=0
<span class="linenr">476: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> k <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">477: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> possible[k][j]==1:
<span class="linenr">478: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   resultat.append([k,j])
<span class="linenr">479: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">nombre_de_1</span>+=1
<span class="linenr">480: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> nombre_de_1==1 :
<span class="linenr">481: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> resultat
<span class="linenr">482: </span>
<span class="linenr">483: </span>
<span class="linenr">484: </span>
<span class="linenr">485: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">analyse des carres 3x3</span>
<span class="linenr">486: </span>
<span class="linenr">487: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> carre <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">488: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">resultat</span>=[]
<span class="linenr">489: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">nombre_de_1</span>=0
<span class="linenr">490: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> k <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">491: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> possible[3*(carre//3)+k//3][3*(carre%3)+k%3]==1:
<span class="linenr">492: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   resultat.append([3*(carre//3)+k//3,3*(carre%3)+k%3])
<span class="linenr">493: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">nombre_de_1</span>+=1
<span class="linenr">494: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> nombre_de_1==1 :
<span class="linenr">495: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> resultat
<span class="linenr">496: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> resultat        
<span class="linenr">497: </span>
<span class="linenr">498: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">___________________ fin ou_le_nombre_peut_etre_________________________________</span>
</pre>
</div>


<p>
La fonction <code>ou_le_nombre_peut_etre</code> va rechercher dans quelles cases un nombre peut être placé.
On crée pour cela un tableau <code>possible</code> de même dimension que la grille qui contiendra 0 si le 
nombre ne peut pas être à la position et 1 si le nombre peut être à la position.
Au départ toutes les cases sont possibles et l'on place la valeur 1 dans toutes les cases.
Ensuite au fur et à mesure on va éliminer les possibilités en placant des 0.
</p>
</div>

<ol class="org-ol">
<li><a id="org0fdc2a1"></a>Recherche d'un singleton caché<br />
<div class="outline-text-5" id="text-3-3-1-1">
<p>
On étudie une à une les cases de la grille (une boucle for pour les lignes : i , une boucle for pour les colonnes : j)
</p>
<ul class="org-ul">
<li>Si la grille contient déjà une valeur (if tab[i][j]!=0), la valeur ne peut être dans la case et donc elle est notée comme impossible : possible[i][j]=0</li>
<li>Si la grille contient le nombre que l'on teste :</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">for</span> k <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span style="background-color: #f2f2f2;"> </span>   possible[i][k] = 0  <span style="color: #b22222;"># </span><span style="color: #b22222;">on met toute la ligne &#224; 0</span>
<span style="background-color: #f2f2f2;"> </span>   possible[k][j] = 0  <span style="color: #b22222;">#</span><span style="color: #b22222;">on met toute la colonne  &#224; 0</span>
<span style="background-color: #f2f2f2;"> </span>   possible[3*(carre//3)+k//3][3*(carre%3)+k%3] = 0  <span style="color: #b22222;"># </span><span style="color: #b22222;">et tout le carr&#233;</span>
</pre>
</div>


<p>
Ainsi s'il ne reste plus qu'un seul 1 dans une région (ligne, colonne ou carré) ce sera la valeur.
</p>
</div>
</li>


<li><a id="org34927ca"></a>Élimination indirecte<br />
<div class="outline-text-5" id="text-3-3-1-2">
<p>
Le 1 de la ligne D impose un 1 dans la colonne g dans le rectangle milieu droit.
</p>

<p>
Le 1 du rectangle inférieur droit ne peut donc pas être :
</p>
<ul class="org-ul">
<li>Colonne g</li>
<li><p>
Lignes H et J
La seule possibilité : G, j
</p>

<p>
C'est cela que nous allons rechercher dans cette deuxième partie.
</p>

<p>
J'ai numéroté les grands carrés de 0 à 8 le 0 correspondant à celui en haut à gauche, le 8 en  bas à droite.
</p>

<p>
On passe en revue tous les carrés. Dans un carré si on rencontre une case possible pour notre valeur : 
</p></li>
<li>On enregistre la position de sa colonne dans <code>debut_colonne</code> si c'est la première valeur  rencontrée (on a alors <code>debut_colonne = 10</code>)</li>
<li><p>
Si c'est une des suivantes, on enregistre sa position dans fin<sub>colonne</sub>.
</p>

<p>
On connaît alors la colonne de la première possibilité et celle de la dernière.
</p>

<p>
Si elles ont sur la même colonne, cela veut dire que la valeur cherchée ne se retrouvera pas dans  cette colonne dans un autre carré.
</p>

<p>
On met donc toute cette colonne à 0 sauf dans le carré concerné.
</p>

<p>
On recommence l'opération pour les lignes. Le raisonnement est identique. On aurait pu transposer  la grille et refaire d=strictement le même programme.
</p></li>
</ul>
</div>
</li>

<li><a id="org526a8c1"></a>Analyse des lignes<br />
<div class="outline-text-5" id="text-3-3-1-3">
<p>
On analyse ensuite les différentes lignes de la grille à la recherche d'un 1 isolé sur la ligne :
</p>
<ul class="org-ul">
<li>Si on rencontre un 1, on enregistre ses coordonnées (ligne,colonne) dans un tableau de  résultats.</li>
<li>Si sur la ligne on a trouvé un seul 1, on renvoie ses coordonnées.</li>
</ul>
</div>
</li>
<li><a id="orgfd651c2"></a>Analyse des colonnes<br />
<div class="outline-text-5" id="text-3-3-1-4">
<p>
Même chose avec les colonnes.
</p>
</div>
</li>
<li><a id="org22873e5"></a>Analyse des carrés 3x3<br />
<div class="outline-text-5" id="text-3-3-1-5">
<p>
Même chose avec les carrés.
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-orgda64f72" class="outline-4">
<h4 id="orgda64f72"><span class="section-number-4">3.3.2</span> Groupes nus et cachés</h4>
<div class="outline-text-4" id="text-3-3-2">
<p>
À partir de ce niveau de difficulté, j'ai abandonné le tableau des 1 indiquant où il était possible de trouver une valeur au profit d'un tableau des possibles, indiquant pour chaque case une liste des prétendants et une liste vide si la case a une valeur trouvée.
</p>
</div>
</div>
<div id="outline-container-orgc419ffa" class="outline-4">
<h4 id="orgc419ffa"><span class="section-number-4">3.3.3</span> Groupes nus</h4>
<div class="outline-text-4" id="text-3-3-3">
<p>
Lorsque l'on rencontre dans une même région une paire de  (comme ici 7-8) en 2 endroits sur la même colonne, on est sûr que les 2 valeurs seront dans l'une des 2 cases et que par conséquent elles ne seront pas ailleurs dans la région. On pourra donc éliminer cette paire de tous les prétendants de la région excepté dans les 2 endroits où on les a trouvés.
</p>

<p>
J'ai dans un premier temps  créé une fonction retrouvant les paires puis une autre les triplets, car le raisonnement est le même avec 3 triplets identiques dans une même région. (Voir FonctionsEnPlus)
</p>

<p>
Je me suis ensuite rendu compte qu'un groupe abc pouvait être incomplet :
</p>

<p>
Si on a abc puis abc puis ab, sans qu'il y ait égalité des groupes, on pouvait quand même éliminer des candidats de la région. De plus on pouvait faire 4 groupes de 4 ou 5 groupes de 5… et il aurait fallu faire autant de fonctions différentes. Je me suis donc consacré à la recherche des groupes nus quel que soit leur taille.
</p>


<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Programme&nbsp;28&nbsp;: </span>groupes nus</label><pre class="src src-python" id="org4aa12f7"><span class="linenr">500: </span><span style="color: #b22222;"># </span><span style="color: #b22222;">---------  fonctions gerant a la fois tous les groupes nus de toutes tailles -------</span>
<span class="linenr">501: </span>
<span class="linenr">502: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">groupes_nus_ligne</span>(grille_pos,ligne):
<span class="linenr">503: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> colonne <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">504: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">liste_index</span>=[]
<span class="linenr">505: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">liste</span>=grille_pos[ligne][colonne]
<span class="linenr">506: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> index <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">507: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> intersection_2_listes(liste,grille_pos[ligne][index])==grille_pos[ligne][index] <span style="color: #a020f0;">and</span> <span style="color: #483d8b;">len</span>(liste)&gt;1 <span style="color: #a020f0;">and</span> <span style="color: #483d8b;">len</span>(grille_pos[ligne][index])&gt;1:
<span class="linenr">508: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   liste_index.append(index)
<span class="linenr">509: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> <span style="color: #483d8b;">len</span>(liste)==<span style="color: #483d8b;">len</span>(liste_index) :
<span class="linenr">510: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> index <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9) :
<span class="linenr">511: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> index <span style="color: #a020f0;">not</span> <span style="color: #a020f0;">in</span> liste_index :
<span class="linenr">512: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> element <span style="color: #a020f0;">in</span> liste :
<span class="linenr">513: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> element <span style="color: #a020f0;">in</span> grille_pos[ligne][index] :
<span class="linenr">514: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   grille_pos[ligne][index].remove(element)
<span class="linenr">515: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> grille_pos
<span class="linenr">516: </span>
<span class="linenr">517: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">groupes_nus_colonne</span>(grille_pos,colonne):
<span class="linenr">518: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> ligne <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">519: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">liste_inclus</span>=[]
<span class="linenr">520: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">liste</span>=grille_pos[ligne][colonne]
<span class="linenr">521: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> index <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">522: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> intersection_2_listes(liste,grille_pos[index][colonne])==grille_pos[index][colonne]<span style="color: #a020f0;">and</span> <span style="color: #483d8b;">len</span>(liste)&gt;1 <span style="color: #a020f0;">and</span> <span style="color: #483d8b;">len</span>(grille_pos[index][colonne])&gt;1:
<span class="linenr">523: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   liste_inclus.append(index)
<span class="linenr">524: </span>
<span class="linenr">525: </span>
<span class="linenr">526: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> <span style="color: #483d8b;">len</span>(liste)==<span style="color: #483d8b;">len</span>(liste_inclus) :
<span class="linenr">527: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> index <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9) :
<span class="linenr">528: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> index <span style="color: #a020f0;">not</span> <span style="color: #a020f0;">in</span> liste_inclus :
<span class="linenr">529: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> element <span style="color: #a020f0;">in</span> liste :
<span class="linenr">530: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> element <span style="color: #a020f0;">in</span> grille_pos[index][colonne]:
<span class="linenr">531: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   grille_pos[index][colonne].remove(element)
<span class="linenr">532: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> grille_pos
<span class="linenr">533: </span>
<span class="linenr">534: </span>
<span class="linenr">535: </span><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">groupes_nus_carre</span>(grille_pos,carre):
<span class="linenr">536: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> position <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">537: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">liste_inclus</span>=[]
<span class="linenr">538: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a0522d;">liste</span>=grille_pos[3*(carre//3)+position//3][3*(carre%3)+position%3]
<span class="linenr">539: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> index <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9):
<span class="linenr">540: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> intersection_2_listes(liste,grille_pos[3*(carre//3)+index//3][3*(carre%3)+index%3])==grille_pos[3*(carre//3)+index//3][3*(carre%3)+index%3]<span style="color: #a020f0;">and</span> <span style="color: #483d8b;">len</span>(liste)&gt;1 <span style="color: #a020f0;">and</span> <span style="color: #483d8b;">len</span>(grille_pos[3*(carre//3)+index//3][3*(carre%3)+index%3])&gt;1:
<span class="linenr">541: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   liste_inclus.append(index)
<span class="linenr">542: </span>
<span class="linenr">543: </span>
<span class="linenr">544: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> <span style="color: #483d8b;">len</span>(liste)==<span style="color: #483d8b;">len</span>(liste_inclus) :
<span class="linenr">545: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> index <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(9) :
<span class="linenr">546: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> index <span style="color: #a020f0;">not</span> <span style="color: #a020f0;">in</span> liste_inclus :
<span class="linenr">547: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">for</span> element <span style="color: #a020f0;">in</span> liste :
<span class="linenr">548: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">if</span> element <span style="color: #a020f0;">in</span> grille_pos[3*(carre//3)+index//3][3*(carre%3)+index%3]:
<span class="linenr">549: </span><span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   <span style="background-color: #f2f2f2;"> </span>   grille_pos[3*(carre//3)+index//3][3*(carre%3)+index%3].remove(element)
<span class="linenr">550: </span><span style="background-color: #f2f2f2;"> </span>   <span style="color: #a020f0;">return</span> grille_pos
<span class="linenr">551: </span>
<span class="linenr">552: </span>
<span class="linenr">553: </span><span style="color: #b22222;">#</span><span style="color: #b22222;">____FIN  fonctions gerant a la fois les groupes nus de toutes tailles________________</span>
</pre>
</div>


<p>
La fonction <code>groupes_nus_ligne</code> (programme <a href="#org4aa12f7">28</a>) recherche de groupes nus dans une ligne.
</p>

<p>
Les paramètres passés sont la grille des possibles et la ligne. La fonction modifie la grille des possibles.
</p>

<p>
On teste toutes les colonnes, pour chaque colonne :
</p>
<ul class="org-ul">
<li>La liste est définie comme les candidats de la case de la ligne et de la colonne</li>
<li>On crée une liste d'index vide</li>
<li>On teste tous les éléments de la ligne (y compris ceux de la colonne considérée) : Si les candidats de la case sont inclus dans ceux de la liste et la case non vide et la liste non vide, on rajoute l'index (n° de la colonne) à la liste des index.</li>
<li>Si la liste contient autant d'éléments que l'on a trouvé de colonne, on a mis à jour un groupe nu, les éléments de cette liste sont donc dans la liste des index : <code>liste_index</code>. Ils ne sont donc pas dans les autres cases de la ligne.</li>
</ul>

<p>
On élimine donc tous les éléments de la liste des autres cases de la ligne de la grille des possibles.
</p>

<p>
Idem pour les colonnes avec la fonction <code>groupes_nus_colonne</code>. 
</p>

<p>
Idem pour les carrés  avec la fonction <code>groupes_nus_carre</code>.
</p>
</div>
</div>

<div id="outline-container-org8b00484" class="outline-4">
<h4 id="org8b00484"><span class="section-number-4">3.3.4</span> Groupes cachés</h4>
<div class="outline-text-4" id="text-3-3-4">
<p>
On cherche cette fois des groupes de prétendants qui sont cachés parmi d'autres prétendants. 
</p>

<p>
Comme ici le groupe 124 que l'on retrouve 2 fois entier et une fois partiellement.
</p>

<p>
Ces 3 éléments sont donc forcément dans les 3 cases et par conséquent les autres prétendants n'y sont pas.
</p>

<p>
L'idée pour trouver ces groupes : créer une liste des positions de chaque élément et comparer les éléments de la liste.
</p>


<p>
On teste une à une toutes les lignes de la grille. Pour chaque ligne :
</p>

<p>
On crée la liste de toutes les positions possibles pour chacune des valeurs de 1 à 9 : <code>liste_position</code>
</p>

<p>
On va ensuite comparer les listes de position aux autres et si l'on en trouve une incluse dans la référence, on va enregistrer sa valeur (index) dans la liste des index. L'index correspond à 1 près à la valeur du candidat.
</p>

<p>
S'il y a autant de groupes que de candidats dans la liste :
</p>
<ul class="org-ul">
<li>On va créer la liste des valeurs en décalant de 1 les index de la liste des index</li>
<li>Pour tout <code>k</code> de la liste des positions: Pour toutes les valeurs <code>val</code>  qui ne sont pas dans la liste des valeurs, on va les ôter de la liste des possibles.</li>
</ul>

<p>
Idem pour les carrés.
</p>

<p>
Idem pour les colonnes.
</p>
</div>
</div>

<div id="outline-container-org570de18" class="outline-4">
<h4 id="org570de18"><span class="section-number-4">3.3.5</span> X-WING</h4>
<div class="outline-text-4" id="text-3-3-5">
<p>
Si sur 2 lignes, on retrouve un même candidat sur 2 mêmes colonnes uniquement, dans les colonnes des sommets, cette valeur peut être éliminée de tous les prétendants des colonnes des sommets sauf celles des lignes des sommets .
</p>




<p>
Pour une valeur k donnée, on va enregistrer pour chaque ligne chaque fois que l'on a trouvé 2 fois la valeur : la ligne, la première position, la seconde position.
</p>

<p>
À l'aide de deux index (index1 et index2) on va tester toutes les lignes 2 à 2.
</p>

<p>
Si on retrouve deux listes ayant les 2 mêmes colonnes, on a un X-wing, alors :
</p>
<ul class="org-ul">
<li>Pour tous les éléments de la colonne de gauche qui ne sont pas sur la première ligne, si k est présent, on le retire de la liste des possibles.</li>
<li>Pour tous les éléments de la colonne de droite qui ne sont pas sur la première ligne, si k est présent, on le retire de la liste des possibles.</li>
</ul>

<p>
On retourne la liste des possibles modifiée.
</p>

<p>
Idem Pour les colonnes.
</p>
</div>
</div>

<div id="outline-container-orgba33e76" class="outline-4">
<h4 id="orgba33e76"><span class="section-number-4">3.3.6</span> Sword-fish</h4>
<div class="outline-text-4" id="text-3-3-6">
<p>
C'est une extension du X-wing : si sur trois lignes différentes, un candidat n'apparaît que sur trois colonnes (voir exemples ci-contre), alors on supprime ce candidat sur les trois colonnes sauf sur les trois lignes de la grille des possibles.
</p>

<p>
Pour cela j'ai créé 3 fonctions :
</p>
<ul class="org-ul">
<li><code>liste_des_sommets</code> qui enregistre toutes les paires de sommets</li>
<li><code>groupes_de_3</code> qui vérifie que dans la liste des sommets on peut en trouver 3 alignés</li>
<li><code>sword_fish</code> qui va supprimer sur les colonnes la valeur aux bons endroits.</li>
</ul>

<p>
Pour chacune des lignes, on ajoute à la <code>liste_sommets_ligne</code> la ligne et la  colonne où se trouve la valeur.
</p>

<p>
Si dans <code>liste_sommets_ligne</code>,il y a 2 éléments, on rajoute ces 2éléments à <code>liste_des_sommets</code>.
</p>

<p>
On passe en paramètre : une grille des possibles, la liste des sommets trouvés avec la fonction précédente, la valeur recherchée. La fonction retourne la grille des possibles modifiée.
</p>

<p>
La <code>liste_des_sommets</code> est rangée sous la forme <code>[ligne1, colonne1, ligne2, colonne2…]</code>.
</p>

<p>
On commence par créer une liste [0, 1, 2…] comportant autant de valeurs qu'il y a de sommets.
</p>

<p>
On va créer ensuite toutes les combinaisons possibles de 3 éléments des valeurs de la liste qui serviront d'indice pour tester les combinaisons des différents sommets avec la fonction <code>sword_fish</code> suivante.
</p>

<p>
On fait la liste des <code>colonnes_trouvées</code> en rajoutant pour tous les sommets la colonne où il se trouve à condition que cette colonne n'ait pas déjà été enregistrée.
</p>

<p>
Si le nombre de colonnes<sub>trouvées</sub> n'est pas égal à 3 on ne peut pas faire de sword-fish et la 
<code>grille_des_possibles</code> n'est pas modifiée.
</p>

<p>
Sinon on vérifie que l'on a pas 2 listes de sommets identiques et là, on est sûr d'être dans le cas du sword-fish et l'on élimine de la grille des possibles  ce candidat sur les trois colonnes sauf sur les trois lignes.
</p>

<p>
Les mêmes fonctions pour un sword-fish sur les colonnes.
</p>
</div>
</div>

<div id="outline-container-orge1eb566" class="outline-4">
<h4 id="orge1eb566"><span class="section-number-4">3.3.7</span> Cas où un choix s'impose</h4>
<div class="outline-text-4" id="text-3-3-7">
<p>
Lorsque qu'aucune des méthodes précédentes n'arrive à se sortir d'une impasse, il arrive que l'on soit obligé de faire une hypothèse pour une case. C'est le cas si sur une ligne et une colonne on a les 2 mêmes prétendants en 2 cases différentes.
</p>

<p>
On passe pour paramètres : la grille des possibles, la grille de sudoku traitée et le choix (0 ou 1) que l'on va faire quand à l'hypothèse à prendre.
</p>

<p>
On recherche dans tout le tableau de la <code>grille_des_possibles</code> un couple de candidats.
</p>

<p>
On cherche si ce couple est présent sur la même ligne et sur la même colonne. Si c'est le cas on modifie la <code>grille_de_sudoku</code> et la <code>grille_des_possibles</code> avec le choix 0 ou 1 et l'on renvoie ces nouvelles grilles comme hypothèse de départ. Bien entendu si le premier choix ne mène pas à la solution finale,  il faudra tester le deuxième cas.
</p>

<p>
Une deuxième variante de recherche en cas de blocage avec recherche de 2 cases contenant les mêmes prétendants sur une même ligne, une même grande colonne ou un carré de 9.
</p>
</div>
</div>
</div>

<div id="outline-container-org4160ef5" class="outline-3">
<h3 id="org4160ef5"><span class="section-number-3">3.4</span> La résolution</h3>
<div class="outline-text-3" id="text-3-4">
<p>
On fait subir aux grilles toutes les fonctions sauf la fonction <code>essai_erreur</code>, les unes après les autres.
</p>

<p>
Les deux premières bouclant jusqu'à ce qu'elles ne trouvent plus de solution (ce sont des fonctions 
simples qui remplissent beaucoup de cases sans consommer trop de puissance de calcul).
</p>


<p>
On crée 2 tableaux <code>memogrille</code> et <code>memopossible</code> au cas où on ait besoin de faire la fonction 
<code>essai_erreur</code>.
</p>

<p>
On boucle sur la fonction de résolution précédente jusqu'à ce que le tableau soit rempli ou un 
nombre d'essais donné, pour éviter de rester coincé dans la boucle.
</p>

<p>
Si la grille n'est pas résolue, on mémorise les 2 grilles (sudoku et possibles) on teste avec la fonction <code>essai_erreur</code> et le choix 0 si l'on peut résoudre.
</p>

<p>
Si l'on n'a pas résolu on teste avec la fonction <code>essai_erreur</code> et le choix 1 si l'on peut résoudre.
</p>

<p>
Deuxième version de la fonction résolution :
</p>

<p>
Après avoir mémorisé l'état de la grille, on teste une des valeurs puis l'autre avec la première version de la fonction <code>essai_erreur</code>. Si on n'a pas réussi, on revient à la grille mémorisée et l'on teste la deuxième version <code>essai_erreur2</code>. 
</p>
</div>
</div>

<div id="outline-container-org1771f92" class="outline-3">
<h3 id="org1771f92"><span class="section-number-3">3.5</span> Épilogue</h3>
<div class="outline-text-3" id="text-3-5">
<p>
On doit pouvoir trouver des grilles qui ne peuvent pas être résolues.
</p>

<p>
En particulier, je pense que la méthode sword-fish peut être étendue à des carrés imbriqués plus 
complexes.
</p>

<p>
Je n'ai pas non plus implémenté la théorie des chaînes.
</p>

<p>
Et la fonction <code>essai_erreur</code> pourrait être étendue à des choix plus multiples.
</p>

<p>
Mais ces fonctions arrivent à résoudre les sudokus les plus difficiles que j'ai pu trouver (diaboliques) et même ceux à 17 cases remplies.
</p>
</div>
</div>
</div>

<div id="outline-container-org2d9f292" class="outline-2">
<h2 id="org2d9f292"><span class="section-number-2">4</span> Troisième version</h2>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Auteur: Raoul HATTERER &amp; Jean-Luc COSSALTER</p>
<p class="date">Created: 2019-08-29 jeu. 02:39</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
